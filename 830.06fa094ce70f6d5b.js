(self.webpackChunkmf_catalog=self.webpackChunkmf_catalog||[]).push([[830],{9830:(ee,Z,A)=>{A.r(Z),A.d(Z,{INITIAL_CONFIG:()=>w,NEW_CONFIG:()=>x,NGX_MASK_CONFIG:()=>I,NgxMaskDirective:()=>se,NgxMaskPipe:()=>re,NgxMaskService:()=>L,initialConfig:()=>b,provideEnvironmentNgxMask:()=>ie,provideNgxMask:()=>q,timeMasks:()=>V,withoutValidation:()=>P});var j=A(467),c=A(3274),H=A(8648),F=A(6762),i=function(o){return o.SEPARATOR="separator",o.PERCENT="percent",o.IP="IP",o.CPF_CNPJ="CPF_CNPJ",o.MONTH="M",o.MONTHS="M0",o.MINUTE="m",o.HOUR="h",o.HOURS="H",o.MINUTES="m0",o.HOURS_HOUR="Hh",o.SECONDS="s0",o.HOURS_MINUTES_SECONDS="Hh:m0:s0",o.EMAIL_MASK="A*@A*.A*",o.HOURS_MINUTES="Hh:m0",o.MINUTES_SECONDS="m0:s0",o.DAYS_MONTHS_YEARS="d0/M0/0000",o.DAYS_MONTHS="d0/M0",o.DAYS="d0",o.DAY="d",o.SECOND="s",o.LETTER_S="S",o.DOT=".",o.COMMA=",",o.CURLY_BRACKETS_LEFT="{",o.CURLY_BRACKETS_RIGHT="}",o.MINUS="-",o.OR="||",o.HASH="#",o.EMPTY_STRING="",o.SYMBOL_STAR="*",o.SYMBOL_QUESTION="?",o.SLASH="/",o.WHITE_SPACE=" ",o.NUMBER_ZERO="0",o.NUMBER_NINE="9",o.BACKSPACE="Backspace",o.DELETE="Delete",o.ARROW_LEFT="ArrowLeft",o.ARROW_UP="ArrowUp",o.DOUBLE_ZERO="00",o}(i||{});const I=new c.InjectionToken("ngx-mask config"),x=new c.InjectionToken("new ngx-mask config"),w=new c.InjectionToken("initial ngx-mask config"),b={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:[".",","],clearIfNotMatch:!1,showMaskTyped:!1,instantPrefix:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:!1,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,apm:!1,leadZero:!1,keepCharacterPositions:!1,triggerOnMaskChange:!1,inputTransformFn:o=>o,outputTransformFn:o=>o,maskFilled:new c.EventEmitter,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},U:{pattern:new RegExp("[A-Z]")},L:{pattern:new RegExp("[a-z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},V=[i.HOURS_MINUTES_SECONDS,i.HOURS_MINUTES,i.MINUTES_SECONDS],P=[i.PERCENT,i.HOURS_HOUR,i.SECONDS,i.MINUTES,i.SEPARATOR,i.DAYS_MONTHS_YEARS,i.DAYS_MONTHS,i.DAYS,i.MONTHS];let Q=(()=>{class o{_config=(0,c.inject)(I);dropSpecialCharacters=this._config.dropSpecialCharacters;hiddenInput=this._config.hiddenInput;clearIfNotMatch=this._config.clearIfNotMatch;specialCharacters=this._config.specialCharacters;patterns=this._config.patterns;prefix=this._config.prefix;suffix=this._config.suffix;thousandSeparator=this._config.thousandSeparator;decimalMarker=this._config.decimalMarker;customPattern;showMaskTyped=this._config.showMaskTyped;placeHolderCharacter=this._config.placeHolderCharacter;validation=this._config.validation;separatorLimit=this._config.separatorLimit;allowNegativeNumbers=this._config.allowNegativeNumbers;leadZeroDateTime=this._config.leadZeroDateTime;leadZero=this._config.leadZero;apm=this._config.apm;inputTransformFn=this._config.inputTransformFn;outputTransformFn=this._config.outputTransformFn;keepCharacterPositions=this._config.keepCharacterPositions;instantPrefix=this._config.instantPrefix;_shift=new Set;plusOnePosition=!1;maskExpression="";actualValue="";showKeepCharacterExp="";shownMaskExpression="";deletedSpecialCharacter=!1;ipError;cpfCnpjError;applyMask(t,e,r=0,s=!1,n=!1,u=(()=>{})){if(!e||"string"!=typeof t)return i.EMPTY_STRING;let l=0,h="",f=!1,_=!1,d=1,M=!1,a=t,m=r;a.slice(0,this.prefix.length)===this.prefix&&(a=a.slice(this.prefix.length,a.length)),this.suffix&&a.length>0&&(a=this.checkAndRemoveSuffix(a)),"("===a&&this.prefix&&(a="");const v=a.toString().split(i.EMPTY_STRING);if(this.allowNegativeNumbers&&a.slice(l,l+1)===i.MINUS&&(h+=a.slice(l,l+1)),e===i.IP){const S=a.split(i.DOT);this.ipError=this._validIP(S),e="099.099.099.099"}const E=[];for(let S=0;S<a.length;S++)a[S]?.match("\\d")&&E.push(a[S]??i.EMPTY_STRING);if(e===i.CPF_CNPJ&&(this.cpfCnpjError=11!==E.length&&14!==E.length,e=E.length>11?"00.000.000/0000-00":"000.000.000-00"),e.startsWith(i.PERCENT)){if(a.match("[a-z]|[A-Z]")||a.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)&&!n){a=this._stripToDecimal(a);const N=this.getPrecision(e);a=this.checkInputPrecision(a,N,this.decimalMarker)}const S="string"==typeof this.decimalMarker?this.decimalMarker:i.DOT;if(a.indexOf(S)>0&&!this.percentage(a.substring(0,a.indexOf(S)))){let N=a.substring(0,a.indexOf(S)-1);this.allowNegativeNumbers&&a.slice(l,l+1)===i.MINUS&&!n&&(N=a.substring(0,a.indexOf(S))),a=`${N}${a.substring(a.indexOf(S),a.length)}`}let p="";p=this.allowNegativeNumbers&&a.slice(l,l+1)===i.MINUS?`${i.MINUS}${a.slice(l+1,l+a.length)}`:a,h=this.percentage(p)?this._splitPercentZero(a):this._splitPercentZero(a.substring(0,a.length-1))}else if(e.startsWith(i.SEPARATOR)){(a.match("[w\u0430-\u044f\u0410-\u042f]")||a.match("[\u0401\u0451\u0410-\u044f]")||a.match("[a-z]|[A-Z]")||a.match(/[-@#!$%\\^&*()_\xa3\xac'+|~=`{}\]:";<>.?/]/)||a.match("[^A-Za-z0-9,]"))&&(a=this._stripToDecimal(a));const S=this.getPrecision(e);let p=this.decimalMarker;if(Array.isArray(this.decimalMarker)&&(p=this.actualValue.includes(this.decimalMarker[0])||this.actualValue.includes(this.decimalMarker[1])?this.actualValue.includes(this.decimalMarker[0])?this.decimalMarker[0]:this.decimalMarker[1]:this.decimalMarker.find(g=>g!==this.thousandSeparator)),n){const{decimalMarkerIndex:g,nonZeroIndex:k}=this._findFirstNonZeroAndDecimalIndex(a,p),y=a[0]===i.MINUS;(a[0]===p&&!k||y&&a[1]===p&&!k||a[0]===i.NUMBER_ZERO&&!g&&!k)&&(a=i.NUMBER_ZERO),g&&k&&y&&1===m&&(g<k||g>k)&&(a=i.MINUS+a.slice(k)),!g&&k&&a.length>k&&(a=y?i.MINUS+a.slice(k):a.slice(k)),g&&k&&0===m&&(g<k&&(a=a.slice(g-1)),g>k&&(a=a.slice(k)))}0===S?a=this.allowNegativeNumbers?a.length>2&&a[0]===i.MINUS&&a[1]===i.NUMBER_ZERO&&a[2]!==this.thousandSeparator&&a[2]!==i.COMMA&&a[2]!==i.DOT?"-"+a.slice(2,a.length):a[0]===i.NUMBER_ZERO&&a.length>1&&a[1]!==this.thousandSeparator&&a[1]!==i.COMMA&&a[1]!==i.DOT?a.slice(1,a.length):a:a.length>1&&a[0]===i.NUMBER_ZERO&&a[1]!==this.thousandSeparator&&a[1]!==i.COMMA&&a[1]!==i.DOT?a.slice(1,a.length):a:(a[0]===p&&a.length>1&&!n&&(a=i.NUMBER_ZERO+a.slice(0,a.length+1),this.plusOnePosition=!0),a[0]===i.NUMBER_ZERO&&a[1]!==p&&a[1]!==this.thousandSeparator&&!n&&(a=a.length>1?a.slice(0,1)+p+a.slice(1,a.length+1):a,this.plusOnePosition=!0),this.allowNegativeNumbers&&!n&&a[0]===i.MINUS&&(a[1]===p||a[1]===i.NUMBER_ZERO)&&(a=a[1]===p&&a.length>2?a.slice(0,1)+i.NUMBER_ZERO+a.slice(1,a.length):a[1]===i.NUMBER_ZERO&&a.length>2&&a[2]!==p?a.slice(0,2)+p+a.slice(2,a.length):a,this.plusOnePosition=!0));const N=this._charToRegExpExpression(this.thousandSeparator);let T='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(N,"");if(Array.isArray(this.decimalMarker))for(const g of this.decimalMarker)T=T.replace(this._charToRegExpExpression(g),i.EMPTY_STRING);else T=T.replace(this._charToRegExpExpression(this.decimalMarker),"");const C=new RegExp("["+T+"]");a.match(C)&&(a=a.substring(0,a.length-1)),a=this.checkInputPrecision(a,S,this.decimalMarker);const O=a.replace(new RegExp(N,"g"),"");h=this._formatWithSeparators(O,this.thousandSeparator,this.decimalMarker,S);const X=h.indexOf(i.COMMA)-a.indexOf(i.COMMA),R=h.length-a.length;if((h[m-1]===this.thousandSeparator||h[m-this.prefix.length])&&this.prefix&&n)m-=1;else if(R>0&&h[m]!==this.thousandSeparator||n&&h.length<t.length&&this.separatorLimit){_=!0;let g=0;do{this._shift.add(m+g),g++}while(g<R)}else h[m-1]===this.thousandSeparator||-4===R||-3===R||h[m]===this.thousandSeparator?(this._shift.clear(),this._shift.add(m-1)):0!==X&&m>0&&!(h.indexOf(i.COMMA)>=m&&m>3)||!(h.indexOf(i.DOT)>=m&&m>3)&&R<=0?(this._shift.clear(),_=!0,d=R,m+=R,this._shift.add(m)):this._shift.clear()}else for(let S=0,p=v[0];S<v.length&&l!==e.length;S++,p=v[S]??i.EMPTY_STRING){const N=i.SYMBOL_STAR in this.patterns;if(this._checkSymbolMask(p,e[l]??i.EMPTY_STRING)&&e[l+1]===i.SYMBOL_QUESTION)h+=p,l+=2;else if(e[l+1]===i.SYMBOL_STAR&&f&&this._checkSymbolMask(p,e[l+2]??i.EMPTY_STRING))h+=p,l+=3,f=!1;else if(this._checkSymbolMask(p,e[l]??i.EMPTY_STRING)&&e[l+1]===i.SYMBOL_STAR&&!N)h+=p,f=!0;else if(e[l+1]===i.SYMBOL_QUESTION&&this._checkSymbolMask(p,e[l+2]??i.EMPTY_STRING))h+=p,l+=3;else if(this._checkSymbolMask(p,e[l]??i.EMPTY_STRING)){if(e[l]===i.HOURS&&(this.apm?Number(p)>9:Number(p)>2)){m=this.leadZeroDateTime?m:m+1,l+=1,this._shiftStep(l),S--,this.leadZeroDateTime&&(h+="0");continue}if(e[l]===i.HOUR&&(this.apm?1===h.length&&Number(h)>1||"1"===h&&Number(p)>2||1===a.slice(l-1,l).length&&Number(a.slice(l-1,l))>2||"1"===a.slice(l-1,l)&&Number(p)>2:"2"===h&&Number(p)>3||("2"===h.slice(l-2,l)||"2"===h.slice(l-3,l)||"2"===h.slice(l-4,l)||"2"===h.slice(l-1,l))&&Number(p)>3&&l>10)){m+=1,l+=1,S--;continue}if((e[l]===i.MINUTE||e[l]===i.SECOND)&&Number(p)>5){m=this.leadZeroDateTime?m:m+1,l+=1,this._shiftStep(l),S--,this.leadZeroDateTime&&(h+="0");continue}const T=31,C=a[l],O=a[l+1],X=a[l+2],R=a[l-1],K=a[l-2],g=a.slice(l-3,l-1),k=a.slice(l-1,l+1),y=a.slice(l,l+2),W=a.slice(l-2,l);if(e[l]===i.DAY){const z=e.slice(0,2)===i.MONTHS,G=e.slice(0,2)===i.MONTHS&&this.specialCharacters.includes(K);if(Number(p)>3&&this.leadZeroDateTime||!z&&(Number(y)>T||Number(k)>T||this.specialCharacters.includes(O))||(G?Number(k)>T||!this.specialCharacters.includes(C)&&this.specialCharacters.includes(X)||this.specialCharacters.includes(C):Number(y)>T||this.specialCharacters.includes(O)&&!n)){m=this.leadZeroDateTime?m:m+1,l+=1,this._shiftStep(l),S--,this.leadZeroDateTime&&(h+="0");continue}}if(e[l]===i.MONTH){const G=0===l&&(Number(p)>2||Number(y)>12||this.specialCharacters.includes(O)&&!n),ae=e.slice(l+2,l+3),ne=g.includes(ae)&&e.includes("d0")&&(this.specialCharacters.includes(K)&&Number(k)>12&&!this.specialCharacters.includes(C)||this.specialCharacters.includes(C)),le=Number(g)<=T&&!this.specialCharacters.includes(g)&&this.specialCharacters.includes(R)&&(Number(y)>12||this.specialCharacters.includes(O)),he=Number(y)>12&&5===l||this.specialCharacters.includes(O)&&5===l,ce=Number(g)>T&&!this.specialCharacters.includes(g)&&!this.specialCharacters.includes(W)&&Number(W)>12&&e.includes("d0"),oe=Number(g)<=T&&!this.specialCharacters.includes(g)&&!this.specialCharacters.includes(R)&&Number(k)>12;if(Number(p)>1&&this.leadZeroDateTime||G||ne||oe||ce||le||he&&!this.leadZeroDateTime){m=this.leadZeroDateTime?m:m+1,l+=1,this._shiftStep(l),S--,this.leadZeroDateTime&&(h+="0");continue}}h+=p,l++}else this.specialCharacters.includes(p)&&e[l]===p?(h+=p,l++):-1!==this.specialCharacters.indexOf(e[l]??i.EMPTY_STRING)?(h+=e[l],l++,this._shiftStep(l),S--):e[l]===i.NUMBER_NINE&&this.showMaskTyped?this._shiftStep(l):this.patterns[e[l]??i.EMPTY_STRING]&&this.patterns[e[l]??i.EMPTY_STRING]?.optional?(v[l]&&"099.099.099.099"!==e&&"000.000.000-00"!==e&&"00.000.000/0000-00"!==e&&!e.match(/^9+\.0+$/)&&!this.patterns[e[l]??i.EMPTY_STRING]?.optional&&(h+=v[l]),e.includes(i.NUMBER_NINE+i.SYMBOL_STAR)&&e.includes(i.NUMBER_ZERO+i.SYMBOL_STAR)&&l++,l++,S--):this.maskExpression[l+1]===i.SYMBOL_STAR&&this._findSpecialChar(this.maskExpression[l+2]??i.EMPTY_STRING)&&this._findSpecialChar(p)===this.maskExpression[l+2]&&f||this.maskExpression[l+1]===i.SYMBOL_QUESTION&&this._findSpecialChar(this.maskExpression[l+2]??i.EMPTY_STRING)&&this._findSpecialChar(p)===this.maskExpression[l+2]&&f?(l+=3,h+=p):this.showMaskTyped&&this.specialCharacters.indexOf(p)<0&&p!==this.placeHolderCharacter&&1===this.placeHolderCharacter.length&&(M=!0)}h[m-1]&&h.length+1===e.length&&-1!==this.specialCharacters.indexOf(e[e.length-1]??i.EMPTY_STRING)&&(h+=e[e.length-1]);let D=m+1;for(;this._shift.has(D);)d++,D++;let $=s&&!e.startsWith(i.SEPARATOR)?l:this._shift.has(m)?d:0;M&&$--,u($,_),d<0&&this._shift.clear();let Y=!1;n&&(Y=v.every(S=>this.specialCharacters.includes(S)));let B=`${this.prefix}${Y?i.EMPTY_STRING:h}${this.showMaskTyped?"":this.suffix}`;0===h.length&&(B=this.instantPrefix?`${this.prefix}${h}`:`${h}`);const U=1===a.length&&this.specialCharacters.includes(e[0])&&a!==e[0];if(!this._checkSymbolMask(a,e[1])&&U)return"";if(h.includes(i.MINUS)&&this.prefix&&this.allowNegativeNumbers){if(n&&h===i.MINUS)return"";B=`${i.MINUS}${this.prefix}${h.split(i.MINUS).join(i.EMPTY_STRING)}${this.suffix}`}return B}_findDropSpecialChar(t){return Array.isArray(this.dropSpecialCharacters)?this.dropSpecialCharacters.find(e=>e===t):this._findSpecialChar(t)}_findSpecialChar(t){return this.specialCharacters.find(e=>e===t)}_checkSymbolMask(t,e){return this.patterns=this.customPattern?this.customPattern:this.patterns,(this.patterns[e]?.pattern&&this.patterns[e]?.pattern.test(t))??!1}_formatWithSeparators=(t,e,r,s)=>{let n=[],u="";if(Array.isArray(r)){const d=new RegExp(r.map(M=>"[\\^$.|?*+()".indexOf(M)>=0?`\\${M}`:M).join("|"));n=t.split(d),u=t.match(d)?.[0]??i.EMPTY_STRING}else n=t.split(r),u=r;const l=n.length>1?`${u}${n[1]}`:i.EMPTY_STRING;let h=n[0]??i.EMPTY_STRING;const f=this.separatorLimit.replace(/\s/g,i.EMPTY_STRING);f&&+f&&(h=h[0]===i.MINUS?`-${h.slice(1,h.length).slice(0,f.length)}`:h.slice(0,f.length));const _=/(\d+)(\d{3})/;for(;e&&_.test(h);)h=h.replace(_,"$1"+e+"$2");return typeof s>"u"?h+l:0===s?h:h+l.substring(0,s+1)};percentage=t=>{const e=t.replace(",","."),r=Number(this.allowNegativeNumbers&&t.includes(i.MINUS)?e.slice(1,t.length):e);return!isNaN(r)&&r>=0&&r<=100};getPrecision=t=>{const e=t.split(i.DOT);return e.length>1?Number(e[e.length-1]):1/0};checkAndRemoveSuffix=t=>{for(let e=this.suffix?.length-1;e>=0;e--){const r=this.suffix.substring(e,this.suffix?.length);if(t.includes(r)&&e!==this.suffix?.length-1&&(e-1<0||!t.includes(this.suffix.substring(e-1,this.suffix?.length))))return t.replace(r,i.EMPTY_STRING)}return t};checkInputPrecision=(t,e,r)=>{let s=t,n=r;if(e<1/0){if(Array.isArray(n)){const f=n.find(_=>_!==this.thousandSeparator);n=f||n[0]}const u=new RegExp(this._charToRegExpExpression(n)+`\\d{${e}}.*$`),l=s.match(u),h=(l&&l[0]?.length)??0;h-1>e&&(s=s.substring(0,s.length-(h-1-e))),0===e&&this._compareOrIncludes(s[s.length-1],n,this.thousandSeparator)&&(s=s.substring(0,s.length-1))}return s};_stripToDecimal(t){return t.split(i.EMPTY_STRING).filter((e,r)=>{const s="string"==typeof this.decimalMarker?e===this.decimalMarker:this.decimalMarker.includes(e);return e.match("^-?\\d")||e===this.thousandSeparator||s||e===i.MINUS&&0===r&&this.allowNegativeNumbers}).join(i.EMPTY_STRING)}_charToRegExpExpression(t){return t&&(" "===t?"\\s":"[\\^$.|?*+()".indexOf(t)>=0?`\\${t}`:t)}_shiftStep(t){this._shift.add(t+this.prefix.length||0)}_compareOrIncludes(t,e,r){return Array.isArray(e)?e.filter(s=>s!==r).includes(t):t===e}_validIP(t){return!(4===t.length&&!t.some((e,r)=>t.length!==r+1?e===i.EMPTY_STRING||Number(e)>255:e===i.EMPTY_STRING||Number(e.substring(0,3))>255))}_splitPercentZero(t){if(t===i.MINUS&&this.allowNegativeNumbers)return t;const e=t.indexOf("string"==typeof this.decimalMarker?this.decimalMarker:i.DOT),r=this.allowNegativeNumbers&&t.includes(i.MINUS)?"-":"";if(-1===e){const s=parseInt(r?t.slice(1,t.length):t,10);return isNaN(s)?i.EMPTY_STRING:`${r}${s}`}{const s=parseInt(t.replace("-","").substring(0,e),10),n=t.substring(e+1),u=isNaN(s)?"":s.toString();return u===i.EMPTY_STRING?i.EMPTY_STRING:`${r}${u}${"string"==typeof this.decimalMarker?this.decimalMarker:i.DOT}${n}`}}_findFirstNonZeroAndDecimalIndex(t,e){let r=null,s=null;for(let n=0;n<t.length;n++){const u=t[n];if(u===e&&null===r&&(r=n),u&&u>="1"&&u<="9"&&null===s&&(s=n),null!==r&&null!==s)break}return{decimalMarkerIndex:r,nonZeroIndex:s}}static \u0275fac=function(e){return new(e||o)};static \u0275prov=c.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac})}return o})(),L=(()=>{class o extends Q{isNumberValue=!1;maskIsShown="";selStart=null;selEnd=null;maskChanged=!1;maskExpressionArray=[];triggerOnMaskChange=!1;previousValue="";currentValue="";writingValue=!1;_emitValue=!1;_start;_end;onChange=t=>{};_elementRef=(0,c.inject)(c.ElementRef,{optional:!0});document=(0,c.inject)(H.DOCUMENT);_config=(0,c.inject)(I);_renderer=(0,c.inject)(c.Renderer2,{optional:!0});applyMask(t,e,r=0,s=!1,n=!1,u=(()=>{})){if(!e)return t!==this.actualValue?this.actualValue:t;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():i.EMPTY_STRING,this.maskExpression===i.IP&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),this.maskExpression===i.CPF_CNPJ&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),!t&&this.showMaskTyped)return this.formControlResult(this.prefix),`${this.prefix}${this.maskIsShown}${this.suffix}`;const l=t&&"number"==typeof this.selStart?t[this.selStart]??i.EMPTY_STRING:i.EMPTY_STRING;let h="",f=r;if((this.hiddenInput||t&&t.indexOf(i.SYMBOL_STAR)>=0)&&!this.writingValue){let a=t&&1===t.length?t.split(i.EMPTY_STRING):this.actualValue.split(i.EMPTY_STRING);n&&(a=a.slice(0,r).concat(a.slice(r+1))),this.showMaskTyped&&(t=this.removeMask(t),a=this.removeMask(a.join("")).split(i.EMPTY_STRING)),"object"==typeof this.selStart&&"object"==typeof this.selEnd?(this.selStart=Number(this.selStart),this.selEnd=Number(this.selEnd)):t!==i.EMPTY_STRING&&a.length?"number"==typeof this.selStart&&"number"==typeof this.selEnd&&(t.length>a.length?a.splice(this.selStart,0,l):t.length<a.length&&(a.length-t.length==1?a.splice(n?this.selStart-1:t.length-1,1):a.splice(this.selStart,this.selEnd-this.selStart))):a=[],this.showMaskTyped&&!this.hiddenInput&&(h=this.removeMask(t)),h=this.actualValue.length?a.length<t.length?this.shiftTypedSymbols(a.join(i.EMPTY_STRING)):a.length===t.length?a.join(i.EMPTY_STRING):t:t}if(s&&(this.hiddenInput||!this.hiddenInput)&&(h=t),n&&-1!==this.specialCharacters.indexOf(this.maskExpression[f]??i.EMPTY_STRING)&&this.showMaskTyped&&!this.prefix&&(h=this.currentValue),this.deletedSpecialCharacter&&f&&(this.specialCharacters.includes(this.actualValue.slice(f,f+1))?f+=1:e.slice(f-1,f+1)!==i.MONTHS&&(f-=2),this.deletedSpecialCharacter=!1),this.showMaskTyped&&1===this.placeHolderCharacter.length&&!this.leadZeroDateTime&&(h=this.removeMask(h)),h=this.maskChanged?t:h&&h.length?h:t,this.showMaskTyped&&this.keepCharacterPositions&&this.actualValue&&!s&&!this.writingValue){const a=this.dropSpecialCharacters?this.removeMask(this.actualValue):this.actualValue;return this.formControlResult(a),this.actualValue?this.actualValue:`${this.prefix}${this.maskIsShown}${this.suffix}`}const _=super.applyMask(h,e,f,s,n,u);if(this.actualValue=this.getActualValue(_),this.thousandSeparator===i.DOT&&this.decimalMarker===i.DOT&&(this.decimalMarker=i.COMMA),this.maskExpression.startsWith(i.SEPARATOR)&&!0===this.dropSpecialCharacters&&(this.specialCharacters=this.specialCharacters.filter(a=>!this._compareOrIncludes(a,this.decimalMarker,this.thousandSeparator))),(_||""===_)&&(this.previousValue=this.currentValue,this.currentValue=_,this._emitValue=this.previousValue!==this.currentValue||this.maskChanged||this.writingValue||this.previousValue===this.currentValue&&s),this._emitValue&&(this.writingValue&&this.triggerOnMaskChange?requestAnimationFrame(()=>this.formControlResult(_)):this.formControlResult(_)),!this.showMaskTyped||this.showMaskTyped&&this.hiddenInput)return this.hiddenInput?`${this.hideInput(_,this.maskExpression)}${this.maskIsShown.slice(_.length)}`:_;const d=_.length,M=`${this.prefix}${this.maskIsShown}${this.suffix}`;if(this.maskExpression.includes(i.HOURS)){const a=this._numberSkipedSymbols(_);return`${_}${M.slice(d+a)}`}return this.maskExpression===i.IP||this.maskExpression===i.CPF_CNPJ?`${_}${M}`:`${_}${M.slice(d)}`}_numberSkipedSymbols(t){const e=/(^|\D)(\d\D)/g;let r=e.exec(t),s=0;for(;null!=r;)s+=1,r=e.exec(t);return s}applyValueChanges(t,e,r,s=(()=>{})){const n=this._elementRef?.nativeElement;n&&(n.value=this.applyMask(n.value,this.maskExpression,t,e,r,s),n!==this._getActiveElement()&&this.clearIfNotMatchFn())}hideInput(t,e){return t.split(i.EMPTY_STRING).map((r,s)=>this.patterns&&this.patterns[e[s]??i.EMPTY_STRING]&&this.patterns[e[s]??i.EMPTY_STRING]?.symbol?this.patterns[e[s]??i.EMPTY_STRING]?.symbol:r).join(i.EMPTY_STRING)}getActualValue(t){const e=t.split(i.EMPTY_STRING).filter((r,s)=>{const n=this.maskExpression[s]??i.EMPTY_STRING;return this._checkSymbolMask(r,n)||this.specialCharacters.includes(n)&&r===n});return e.join(i.EMPTY_STRING)===t?e.join(i.EMPTY_STRING):t}shiftTypedSymbols(t){let e="";return(t&&t.split(i.EMPTY_STRING).map((s,n)=>{if(this.specialCharacters.includes(t[n+1]??i.EMPTY_STRING)&&t[n+1]!==this.maskExpression[n+1])return e=s,t[n+1];if(e.length){const u=e;return e=i.EMPTY_STRING,u}return s})||[]).join(i.EMPTY_STRING)}numberToString(t){return!t&&0!==t||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters)||this.maskExpression.startsWith(i.SEPARATOR)&&this.separatorLimit.length>14&&String(t).length>14?String(t):Number(t).toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}).replace(`/${i.MINUS}/`,i.MINUS)}showMaskInInput(t){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}if(this.showMaskTyped){if(t){if(this.maskExpression===i.IP)return this._checkForIp(t);if(this.maskExpression===i.CPF_CNPJ)return this._checkForCpfCnpj(t)}return this.placeHolderCharacter.length===this.maskExpression.length?this.placeHolderCharacter:this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}clearIfNotMatchFn(){const t=this._elementRef?.nativeElement;t&&this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==t.value.replace(this.placeHolderCharacter,i.EMPTY_STRING).length&&(this.formElementProperty=["value",i.EMPTY_STRING],this.applyMask("",this.maskExpression))}set formElementProperty([t,e]){!this._renderer||!this._elementRef||Promise.resolve().then(()=>this._renderer?.setProperty(this._elementRef?.nativeElement,t,e))}checkDropSpecialCharAmount(t){return t.split(i.EMPTY_STRING).filter(r=>this._findDropSpecialChar(r)).length}removeMask(t){return this._removeMask(this._removeSuffix(this._removePrefix(t)),this.specialCharacters.concat("_").concat(this.placeHolderCharacter))}_checkForIp(t){if(t===i.HASH)return`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;const e=[];for(let r=0;r<t.length;r++){const s=t[r]??i.EMPTY_STRING;s&&s.match("\\d")&&e.push(s)}return e.length<=3?`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>3&&e.length<=6?`${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>6&&e.length<=9?this.placeHolderCharacter:""}_checkForCpfCnpj(t){const e=`${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`,r=`${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`;if(t===i.HASH)return e;const s=[];for(let n=0;n<t.length;n++){const u=t[n]??i.EMPTY_STRING;u&&u.match("\\d")&&s.push(u)}return s.length<=3?e.slice(s.length,e.length):s.length>3&&s.length<=6?e.slice(s.length+1,e.length):s.length>6&&s.length<=9?e.slice(s.length+2,e.length):s.length>9&&s.length<11?e.slice(s.length+3,e.length):11===s.length?"":12===s.length?r.slice(17===t.length?16:15,r.length):s.length>12&&s.length<=14?r.slice(s.length+4,r.length):""}_getActiveElement(t=this.document){const e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}formControlResult(t){if(!this.writingValue||t)return this.writingValue||!this.triggerOnMaskChange&&this.maskChanged?(this.triggerOnMaskChange&&this.maskChanged&&this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(t)))))),this.writingValue=!1,void(this.maskChanged=!1)):void(Array.isArray(this.dropSpecialCharacters)?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(t)),this.dropSpecialCharacters))))):this.onChange(this.outputTransformFn(this._toNumber(this.dropSpecialCharacters||!this.dropSpecialCharacters&&this.prefix===t?this._checkSymbols(this._removeSuffix(this._removePrefix(t))):t))));this.onChange(this.outputTransformFn(null))}_toNumber(t){if(!this.isNumberValue||t===i.EMPTY_STRING||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters))return t;if(String(t).length>14&&this.maskExpression.startsWith(i.SEPARATOR))return String(t);const e=Number(t);if(this.maskExpression.startsWith(i.SEPARATOR)&&Number.isNaN(e)){const r=String(t).replace(",",".");return Number(r)}return Number.isNaN(e)?t:e}_removeMask(t,e){return this.maskExpression.startsWith(i.PERCENT)&&t.includes(i.DOT)?t:t&&t.replace(this._regExpForRemove(e),i.EMPTY_STRING)}_removePrefix(t){return this.prefix?t&&t.replace(this.prefix,i.EMPTY_STRING):t}_removeSuffix(t){return this.suffix?t&&t.replace(this.suffix,i.EMPTY_STRING):t}_retrieveSeparatorValue(t){let e=Array.isArray(this.dropSpecialCharacters)?this.specialCharacters.filter(r=>this.dropSpecialCharacters.includes(r)):this.specialCharacters;return!this.deletedSpecialCharacter&&this._checkPatternForSpace()&&t.includes(i.WHITE_SPACE)&&this.maskExpression.includes(i.SYMBOL_STAR)&&(e=e.filter(r=>r!==i.WHITE_SPACE)),this._removeMask(t,e)}_regExpForRemove(t){return new RegExp(t.map(e=>`\\${e}`).join("|"),"gi")}_replaceDecimalMarkerToDot(t){const e=Array.isArray(this.decimalMarker)?this.decimalMarker:[this.decimalMarker];return t.replace(this._regExpForRemove(e),i.DOT)}_checkSymbols(t){let e=t;if(e===i.EMPTY_STRING)return e;this.maskExpression.startsWith(i.PERCENT)&&this.decimalMarker===i.COMMA&&(e=e.replace(i.COMMA,i.DOT));const r=this._retrieveSeparatorPrecision(this.maskExpression),s=0===this.specialCharacters.length?this._retrieveSeparatorValue(e):this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(e));return this.isNumberValue&&r?e===this.decimalMarker?null:s.length>14?String(s):this._checkPrecision(this.maskExpression,s):s}_checkPatternForSpace(){for(const t in this.patterns)if(this.patterns[t]&&this.patterns[t]?.hasOwnProperty("pattern")){const e=this.patterns[t]?.pattern.toString(),r=this.patterns[t]?.pattern;if(e?.includes(i.WHITE_SPACE)&&r?.test(this.maskExpression))return!0}return!1}_retrieveSeparatorPrecision(t){const e=t.match(new RegExp("^separator\\.([^d]*)"));return e?Number(e[1]):null}_checkPrecision(t,e){const r=this.getPrecision(t);let s=e;return t.indexOf("2")>0||this.leadZero&&Number(r)>0?(this.decimalMarker===i.COMMA&&this.leadZero&&(s=s.replace(",",".")),this.leadZero?Number(s).toFixed(Number(r)):Number(s).toFixed(2)):this.numberToString(s)}_repeatPatternSymbols(t){return t.match(/{[0-9]+}/)&&t.split(i.EMPTY_STRING).reduce((e,r,s)=>{if(this._start=r===i.CURLY_BRACKETS_LEFT?s:this._start,r!==i.CURLY_BRACKETS_RIGHT)return this._findSpecialChar(r)?e+r:e;this._end=s;const n=Number(t.slice(this._start+1,this._end)),u=new Array(n+1).join(t[this._start-1]);if(t.slice(0,this._start).length>1&&t.includes(i.LETTER_S)){const l=t.slice(0,this._start-1);return l.includes(i.CURLY_BRACKETS_LEFT)?e+u:l+e+u}return e+u},"")||t}currentLocaleDecimalMarker(){return 1.1.toLocaleString().substring(1,2)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=c.\u0275\u0275getInheritedFactory(o)))(r||o)}})();static \u0275prov=c.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac})}return o})();function te(){const o=(0,c.inject)(w),J=(0,c.inject)(x);return J instanceof Function?{...o,...J()}:{...o,...J}}function q(o){return[{provide:x,useValue:o},{provide:w,useValue:b},{provide:I,useFactory:te},L]}function ie(o){return(0,c.makeEnvironmentProviders)(q(o))}let se=(()=>{class o{mask=(0,c.input)("");specialCharacters=(0,c.input)([]);patterns=(0,c.input)({});prefix=(0,c.input)("");suffix=(0,c.input)("");thousandSeparator=(0,c.input)(" ");decimalMarker=(0,c.input)(".");dropSpecialCharacters=(0,c.input)(null);hiddenInput=(0,c.input)(null);showMaskTyped=(0,c.input)(null);placeHolderCharacter=(0,c.input)(null);shownMaskExpression=(0,c.input)(null);clearIfNotMatch=(0,c.input)(null);validation=(0,c.input)(null);separatorLimit=(0,c.input)("");allowNegativeNumbers=(0,c.input)(null);leadZeroDateTime=(0,c.input)(null);leadZero=(0,c.input)(null);triggerOnMaskChange=(0,c.input)(null);apm=(0,c.input)(null);inputTransformFn=(0,c.input)(null);outputTransformFn=(0,c.input)(null);keepCharacterPositions=(0,c.input)(null);instantPrefix=(0,c.input)(null);maskFilled=(0,c.output)();_maskValue=(0,c.signal)("");_inputValue=(0,c.signal)("");_position=(0,c.signal)(null);_code=(0,c.signal)("");_maskExpressionArray=(0,c.signal)([]);_justPasted=(0,c.signal)(!1);_isFocused=(0,c.signal)(!1);_isComposing=(0,c.signal)(!1);_maskService=(0,c.inject)(L,{self:!0});document=(0,c.inject)(H.DOCUMENT);_config=(0,c.inject)(I);onChange=t=>{};onTouch=()=>{};ngOnChanges(t){const{mask:e,specialCharacters:r,patterns:s,prefix:n,suffix:u,thousandSeparator:l,decimalMarker:h,dropSpecialCharacters:f,hiddenInput:_,showMaskTyped:d,placeHolderCharacter:M,shownMaskExpression:a,clearIfNotMatch:m,validation:v,separatorLimit:E,allowNegativeNumbers:D,leadZeroDateTime:$,leadZero:Y,triggerOnMaskChange:B,apm:U,inputTransformFn:S,outputTransformFn:p,keepCharacterPositions:N,instantPrefix:T}=t;if(e&&(e.currentValue!==e.previousValue&&!e.firstChange&&(this._maskService.maskChanged=!0),e.currentValue&&e.currentValue.split(i.OR).length>1?(this._maskExpressionArray.set(e.currentValue.split(i.OR).sort((C,O)=>C.length-O.length)),this._setMask()):(this._maskExpressionArray.set([]),this._maskValue.set(e.currentValue||i.EMPTY_STRING),this._maskService.maskExpression=this._maskValue())),r){if(!r.currentValue||!Array.isArray(r.currentValue))return;this._maskService.specialCharacters=r.currentValue||[]}if(D&&(this._maskService.allowNegativeNumbers=D.currentValue,this._maskService.allowNegativeNumbers&&(this._maskService.specialCharacters=this._maskService.specialCharacters.filter(C=>C!==i.MINUS))),s&&s.currentValue&&(this._maskService.patterns=s.currentValue),U&&U.currentValue&&(this._maskService.apm=U.currentValue),T&&(this._maskService.instantPrefix=T.currentValue),n&&(this._maskService.prefix=n.currentValue),u&&(this._maskService.suffix=u.currentValue),l&&(this._maskService.thousandSeparator=l.currentValue,l.previousValue&&l.currentValue)){const C=this._maskService.decimalMarker;l.currentValue===this._maskService.decimalMarker&&(this._maskService.decimalMarker=l.currentValue===i.COMMA?i.DOT:i.COMMA),!0===this._maskService.dropSpecialCharacters&&(this._maskService.specialCharacters=this._config.specialCharacters),"string"==typeof C&&"string"==typeof this._maskService.decimalMarker&&(this._inputValue.set(this._inputValue().split(l.previousValue).join("").replace(C,this._maskService.decimalMarker)),this._maskService.actualValue=this._inputValue()),this._maskService.writingValue=!0}h&&(this._maskService.decimalMarker=h.currentValue),f&&(this._maskService.dropSpecialCharacters=f.currentValue),_&&(this._maskService.hiddenInput=_.currentValue,!0===_.previousValue&&!1===_.currentValue&&this._inputValue.set(this._maskService.actualValue)),d&&(this._maskService.showMaskTyped=d.currentValue,!1===d.previousValue&&!0===d.currentValue&&this._isFocused()&&requestAnimationFrame(()=>{this._maskService._elementRef?.nativeElement.click()})),M&&(this._maskService.placeHolderCharacter=M.currentValue),a&&(this._maskService.shownMaskExpression=a.currentValue),m&&(this._maskService.clearIfNotMatch=m.currentValue),v&&(this._maskService.validation=v.currentValue),E&&(this._maskService.separatorLimit=E.currentValue),$&&(this._maskService.leadZeroDateTime=$.currentValue),Y&&(this._maskService.leadZero=Y.currentValue),B&&(this._maskService.triggerOnMaskChange=B.currentValue),S&&(this._maskService.inputTransformFn=S.currentValue),p&&(this._maskService.outputTransformFn=p.currentValue),N&&(this._maskService.keepCharacterPositions=N.currentValue),this._applyMask()}validate({value:t}){const e="number"==typeof t?String(t):t,r=this._maskValue();if(!this._maskService.validation||!r)return null;if(this._maskService.ipError)return this._createValidationError(e);if(this._maskService.cpfCnpjError)return this._createValidationError(e);if(r.startsWith(i.SEPARATOR)||P.includes(r)||this._maskService.clearIfNotMatch)return null;if(V.includes(r))return this._validateTime(e);if(r===i.EMAIL_MASK)return!/^[^@]+@[^@]+\.[^@]+$/.test(e)&&e?this._createValidationError(e):null;if(e&&e.length>=1){let s=0;if(r.includes(i.CURLY_BRACKETS_LEFT)&&r.includes(i.CURLY_BRACKETS_RIGHT))return r.slice(r.indexOf(i.CURLY_BRACKETS_LEFT)+1,r.indexOf(i.CURLY_BRACKETS_RIGHT))===String(e.length)?null:this._createValidationError(e);if(r.startsWith(i.PERCENT))return null;for(const n in this._maskService.patterns)if(this._maskService.patterns[n]?.optional&&(r.indexOf(n)!==r.lastIndexOf(n)?s+=r.split(i.EMPTY_STRING).filter(l=>l===n).join(i.EMPTY_STRING).length:-1!==r.indexOf(n)&&s++,-1!==r.indexOf(n)&&e.length>=r.indexOf(n)||s===r.length))return null;if(r.indexOf(i.SYMBOL_STAR)>1&&e.length<r.indexOf(i.SYMBOL_STAR)||r.indexOf(i.SYMBOL_QUESTION)>1&&e.length<r.indexOf(i.SYMBOL_QUESTION))return this._createValidationError(e);if(-1===r.indexOf(i.SYMBOL_STAR)||-1===r.indexOf(i.SYMBOL_QUESTION)){const n=r.split("*"),u=this._maskService.dropSpecialCharacters?r.length-this._maskService.checkDropSpecialCharAmount(r)-s:this.prefix()?r.length+this.prefix().length-s:r.length-s;if(1===n.length&&e.length<u)return this._createValidationError(e);if(n.length>1){const l=n[n.length-1];if(l&&this._maskService.specialCharacters.includes(l[0])&&String(e).includes(l[0]??"")&&!this.dropSpecialCharacters()){const h=t.split(l[0]);return h[h.length-1].length===l.length-1?null:this._createValidationError(e)}return(l&&!this._maskService.specialCharacters.includes(l[0])||!l||this._maskService.dropSpecialCharacters)&&e.length>=u-1?null:this._createValidationError(e)}}if(1===r.indexOf(i.SYMBOL_STAR)||1===r.indexOf(i.SYMBOL_QUESTION))return null}return t&&this.maskFilled.emit(),null}onPaste(){this._justPasted.set(!0)}onFocus(){this._isFocused.set(!0)}onModelChange(t){(t===i.EMPTY_STRING||null===t||typeof t>"u")&&this._maskService.actualValue&&(this._maskService.actualValue=this._maskService.getActualValue(i.EMPTY_STRING))}onInput(t){if(this._isComposing())return;const e=t.target,r=this._maskService.inputTransformFn(e.value);if("number"!==e.type)if("string"==typeof r||"number"==typeof r){if(e.value=r.toString(),this._inputValue.set(e.value),this._setMask(),!this._maskValue())return void this.onChange(e.value);let s=1===e.selectionStart?e.selectionStart+this._maskService.prefix.length:e.selectionStart;if(this.showMaskTyped()&&this.keepCharacterPositions()&&1===this._maskService.placeHolderCharacter.length){const h=this.suffix(),f=this.prefix(),_=e.value.slice(s-1,s),d=f.length,M=this._maskService._checkSymbolMask(_,this._maskService.maskExpression[s-1-d]??i.EMPTY_STRING),a=this._maskService._checkSymbolMask(_,this._maskService.maskExpression[s+1-d]??i.EMPTY_STRING),m=this._maskService.selStart===this._maskService.selEnd,v=Number(this._maskService.selStart)-d,E=Number(this._maskService.selEnd)-d,D=this._code()===i.BACKSPACE||this._code()===i.DELETE;if(D){if(m){if(!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(s-d,s+1-d))&&m)if(1===v&&f)this._maskService.actualValue=`${f}${this._maskService.placeHolderCharacter}${e.value.split(f).join("").split(h).join("")}${h}`,s-=1;else{const $=e.value.substring(0,s),Y=e.value.substring(s);this._maskService.actualValue=`${$}${this._maskService.placeHolderCharacter}${Y}`}}else this._maskService.actualValue=this._maskService.selStart===d?`${f}${this._maskService.maskIsShown.slice(0,E)}${this._inputValue().split(f).join("")}`:this._maskService.selStart===this._maskService.maskIsShown.length+d?`${this._inputValue()}${this._maskService.maskIsShown.slice(v,E)}`:`${f}${this._inputValue().split(f).join("").slice(0,v)}${this._maskService.maskIsShown.slice(v,E)}${this._maskService.actualValue.slice(E+d,this._maskService.maskIsShown.length+d)}${h}`;s=this._code()===i.DELETE?s+1:s}D||(M||a||!m?this._maskService.specialCharacters.includes(e.value.slice(s,s+1))&&a&&!this._maskService.specialCharacters.includes(e.value.slice(s+1,s+2))?(this._maskService.actualValue=`${e.value.slice(0,s-1)}${e.value.slice(s,s+1)}${_}${e.value.slice(s+2)}`,s+=1):M?this._maskService.actualValue=1===e.value.length&&1===s?`${f}${_}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${h}`:`${e.value.slice(0,s-1)}${_}${e.value.slice(s+1).split(h).join("")}${h}`:f&&1===e.value.length&&s-d==1&&this._maskService._checkSymbolMask(e.value,this._maskService.maskExpression[s-1-d]??i.EMPTY_STRING)&&(this._maskService.actualValue=`${f}${e.value}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${h}`):s=Number(e.selectionStart)-1)}let n=0,u=!1;if(this._code()===i.DELETE&&i.SEPARATOR&&(this._maskService.deletedSpecialCharacter=!0),this._inputValue().length>=this._maskService.maskExpression.length-1&&this._code()!==i.BACKSPACE&&this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&s<10){const h=this._inputValue().slice(s-1,s);e.value=this._inputValue().slice(0,s-1)+h+this._inputValue().slice(s+1)}if(this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&this.leadZeroDateTime()&&(s<3&&Number(e.value)>31&&Number(e.value)<40||5===s&&Number(e.value.slice(3,5))>12)&&(s+=2),this._maskService.maskExpression===i.HOURS_MINUTES_SECONDS&&this.apm()&&(this._justPasted()&&e.value.slice(0,2)===i.DOUBLE_ZERO&&(e.value=e.value.slice(1,2)+e.value.slice(2,e.value.length)),e.value=e.value===i.DOUBLE_ZERO?i.NUMBER_ZERO:e.value),this._maskService.applyValueChanges(s,this._justPasted(),this._code()===i.BACKSPACE||this._code()===i.DELETE,(h,f)=>{this._justPasted.set(!1),n=h,u=f}),this._getActiveElement()!==e)return;if(this._maskService.plusOnePosition&&(s+=1,this._maskService.plusOnePosition=!1),this._maskExpressionArray().length)if(this._code()===i.BACKSPACE){const h=this.specialCharacters().includes(this._maskService.actualValue.slice(s-1,s)),f=this._maskService.removeMask(this._inputValue())?.length===this._maskService.removeMask(this._maskService.maskExpression)?.length,_=this.specialCharacters().includes(this._maskService.actualValue.slice(s,s+1));s=f&&!_?e.selectionStart+1:h?s-1:s}else s=1===e.selectionStart?e.selectionStart+this._maskService.prefix.length:e.selectionStart;this._position.set(1===this._position()&&1===this._inputValue().length?null:this._position());let l=this._position()?this._inputValue().length+s+n:s+(this._code()!==i.BACKSPACE||u?n:0);l>this._getActualInputLength()&&(l=e.value===this._maskService.decimalMarker&&1===e.value.length?this._getActualInputLength()+1:this._getActualInputLength()),l<0&&(l=0),e.setSelectionRange(l,l),this._position.set(null)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof r);else{if(!this._maskValue())return void this.onChange(e.value);this._maskService.applyValueChanges(e.value.length,this._justPasted(),this._code()===i.BACKSPACE||this._code()===i.DELETE)}}onCompositionStart(){this._isComposing.set(!0)}onCompositionEnd(t){this._isComposing.set(!1),this._justPasted.set(!0),this.onInput(t)}onBlur(t){if(this._maskValue()){const e=t.target;if(this._maskService.leadZero&&e.value.length>0&&"string"==typeof this._maskService.decimalMarker){const r=this._maskService.maskExpression,s=this._maskService.decimalMarker,n=this._maskService.suffix,u=Number(this._maskService.maskExpression.slice(r.length-1,r.length));if(u>0){e.value=n?e.value.split(n).join(""):e.value;const l=e.value.split(s)[1];e.value=e.value.includes(s)?e.value+i.NUMBER_ZERO.repeat(u-l.length)+n:e.value+s+i.NUMBER_ZERO.repeat(u)+n,this._maskService.actualValue=e.value}}this._maskService.clearIfNotMatchFn()}this._isFocused.set(!1),this.onTouch()}onClick(t){if(!this._maskValue())return;const e=t.target;null!==e&&null!==e.selectionStart&&e.selectionStart===e.selectionEnd&&e.selectionStart>this._maskService.prefix.length&&38!==t.keyCode&&this._maskService.showMaskTyped&&!this.keepCharacterPositions()&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),e.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===e.value?(e.focus(),e.setSelectionRange(0,0)):e.selectionStart>this._maskService.actualValue.length&&e.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));const n=e&&(e.value===this._maskService.prefix?this._maskService.prefix+this._maskService.maskIsShown:e.value);if(e&&e.value!==n&&(e.value=n),e&&"number"!==e.type&&(e.selectionStart||e.selectionEnd)<=this._maskService.prefix.length){const u=this._maskService.maskExpression.match(new RegExp(`^[${this._maskService.specialCharacters.map(l=>`\\${l}`).join("")}]+`))?.[0].length||0;e.selectionStart=this._maskService.prefix.length+u}else e&&e.selectionEnd>this._getActualInputLength()&&(e.selectionEnd=this._getActualInputLength())}onKeyDown(t){if(!this._maskValue())return;if(this._isComposing())return void("Enter"===t.key&&this.onCompositionEnd(t));this._code.set(t.code?t.code:t.key);const e=t.target;if(this._inputValue.set(e.value),this._setMask(),"number"!==e.type){if(t.key===i.ARROW_UP&&t.preventDefault(),t.key===i.ARROW_LEFT||t.key===i.BACKSPACE||t.key===i.DELETE){if(t.key===i.BACKSPACE&&0===e.value.length&&(e.selectionStart=e.selectionEnd),t.key===i.BACKSPACE&&0!==e.selectionStart){const s=this.prefix().length,n=this.specialCharacters().length?this.specialCharacters():this._config.specialCharacters;if(s>1&&e.selectionStart<=s)e.setSelectionRange(s,e.selectionEnd);else if(this._inputValue().length!==e.selectionStart&&1!==e.selectionStart)for(;n.includes((this._inputValue()[e.selectionStart-1]??i.EMPTY_STRING).toString())&&(s>=1&&e.selectionStart>s||0===s);)e.setSelectionRange(e.selectionStart-1,e.selectionEnd)}this.checkSelectionOnDeletion(e),this._maskService.prefix.length&&e.selectionStart<=this._maskService.prefix.length&&e.selectionEnd<=this._maskService.prefix.length&&t.preventDefault(),t.key===i.BACKSPACE&&!e.readOnly&&0===e.selectionStart&&e.selectionEnd===e.value.length&&0!==e.value.length&&(this._position.set(this._maskService.prefix?this._maskService.prefix.length:0),this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position()))}this.suffix()&&this.suffix().length>1&&this._inputValue().length-this.suffix().length<e.selectionStart?e.setSelectionRange(this._inputValue().length-this.suffix().length,this._inputValue().length):("KeyA"===t.code&&t.ctrlKey||"KeyA"===t.code&&t.metaKey)&&(e.setSelectionRange(0,this._getActualInputLength()),t.preventDefault()),this._maskService.selStart=e.selectionStart,this._maskService.selEnd=e.selectionEnd}}writeValue(t){var e=this;return(0,j.A)(function*(){let r=t;const s=e.inputTransformFn();if("object"==typeof r&&null!==r&&"value"in r&&("disable"in r&&e.setDisabledState(!!r.disable),r=r.value),null!==r&&(r=s?s(r):r),"string"==typeof r||"number"==typeof r||null===r||typeof r>"u"){(null===r||typeof r>"u"||""===r)&&(e._maskService.currentValue="",e._maskService.previousValue="");let n=r;if("number"==typeof n||e._maskValue().startsWith(i.SEPARATOR)){n=String(n);const u=e._maskService.currentLocaleDecimalMarker();Array.isArray(e._maskService.decimalMarker)||(n=e._maskService.decimalMarker!==u?n.replace(u,e._maskService.decimalMarker):n),e._maskService.leadZero&&n&&e.mask()&&!1!==e.dropSpecialCharacters()&&(n=e._maskService._checkPrecision(e._maskService.maskExpression,n)),(e._maskService.decimalMarker===i.COMMA||Array.isArray(e._maskService.decimalMarker)&&e._maskService.thousandSeparator===i.DOT)&&(n=n.toString().replace(i.DOT,i.COMMA)),e.mask()?.startsWith(i.SEPARATOR)&&e.leadZero()&&requestAnimationFrame(()=>{e._maskService.applyMask(n?.toString()??"",e._maskService.maskExpression)}),e._maskService.isNumberValue=!0}("string"!=typeof n||null===r||typeof r>"u")&&(n=""),e._inputValue.set(n),e._setMask(),n&&e._maskService.maskExpression||e._maskService.maskExpression&&(e._maskService.prefix||e._maskService.showMaskTyped)?("function"!=typeof s&&(e._maskService.writingValue=!0),e._maskService.formElementProperty=["value",e._maskService.applyMask(n,e._maskService.maskExpression)],"function"!=typeof s&&(e._maskService.writingValue=!1)):e._maskService.formElementProperty=["value",n],e._inputValue.set(n)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof r)})()}registerOnChange(t){this._maskService.onChange=this.onChange=t}registerOnTouched(t){this.onTouch=t}_getActiveElement(t=this.document){const e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}checkSelectionOnDeletion(t){const e=this.prefix().length,r=this.suffix().length,s=this._inputValue().length;t.selectionStart=Math.min(Math.max(e,t.selectionStart),s-r),t.selectionEnd=Math.min(Math.max(e,t.selectionEnd),s-r)}setDisabledState(t){this._maskService.formElementProperty=["disabled",t]}_applyMask(){this._maskService.maskExpression=this._maskService._repeatPatternSymbols(this._maskValue()||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue(),this._maskService.maskExpression)]}_validateTime(t){const e=this._maskValue().split(i.EMPTY_STRING).filter(r=>":"!==r).length;return t&&(0==+(t[t.length-1]??-1)&&t.length<e||t.length<=e-2)?this._createValidationError(t):null}_getActualInputLength(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}_createValidationError(t){return{mask:{requiredMask:this._maskValue(),actualValue:t}}}_setMask(){this._maskExpressionArray().some(t=>{if(t.split(i.EMPTY_STRING).some(r=>this._maskService.specialCharacters.includes(r))&&this._inputValue()&&this._areAllCharactersInEachStringSame(this._maskExpressionArray())||t.includes(i.CURLY_BRACKETS_LEFT)){const r=this._maskService.removeMask(this._inputValue())?.length<=this._maskService.removeMask(t)?.length;if(r){const s=t.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(t):t;return this._maskValue.set(s),this._maskService.maskExpression=s,r}{const s=this._maskExpressionArray()[this._maskExpressionArray().length-1]??i.EMPTY_STRING,n=s.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(s):s;this._maskValue.set(n),this._maskService.maskExpression=n}}else{const r=this._maskService.removeMask(t),s=this._maskService.removeMask(this._inputValue())?.split(i.EMPTY_STRING).every((n,u)=>{const l=r.charAt(u);return this._maskService._checkSymbolMask(n,l)});if(s||this._justPasted())return this._maskValue.set(t),this._maskService.maskExpression=t,s}})}_areAllCharactersInEachStringSame(t){const e=this._maskService.specialCharacters;return t.map(function r(n){const u=new RegExp(`[${e.map(l=>`\\${l}`).join("")}]`,"g");return n.replace(u,"")}).every(n=>1===new Set(n).size)}static \u0275fac=function(e){return new(e||o)};static \u0275dir=c.\u0275\u0275defineDirective({type:o,selectors:[["input","mask",""],["textarea","mask",""]],hostBindings:function(e,r){1&e&&c.\u0275\u0275listener("paste",function(){return r.onPaste()})("focus",function(n){return r.onFocus(n)})("ngModelChange",function(n){return r.onModelChange(n)})("input",function(n){return r.onInput(n)})("compositionstart",function(n){return r.onCompositionStart(n)})("compositionend",function(n){return r.onCompositionEnd(n)})("blur",function(n){return r.onBlur(n)})("click",function(n){return r.onClick(n)})("keydown",function(n){return r.onKeyDown(n)})},inputs:{mask:[c.\u0275\u0275InputFlags.SignalBased,"mask"],specialCharacters:[c.\u0275\u0275InputFlags.SignalBased,"specialCharacters"],patterns:[c.\u0275\u0275InputFlags.SignalBased,"patterns"],prefix:[c.\u0275\u0275InputFlags.SignalBased,"prefix"],suffix:[c.\u0275\u0275InputFlags.SignalBased,"suffix"],thousandSeparator:[c.\u0275\u0275InputFlags.SignalBased,"thousandSeparator"],decimalMarker:[c.\u0275\u0275InputFlags.SignalBased,"decimalMarker"],dropSpecialCharacters:[c.\u0275\u0275InputFlags.SignalBased,"dropSpecialCharacters"],hiddenInput:[c.\u0275\u0275InputFlags.SignalBased,"hiddenInput"],showMaskTyped:[c.\u0275\u0275InputFlags.SignalBased,"showMaskTyped"],placeHolderCharacter:[c.\u0275\u0275InputFlags.SignalBased,"placeHolderCharacter"],shownMaskExpression:[c.\u0275\u0275InputFlags.SignalBased,"shownMaskExpression"],clearIfNotMatch:[c.\u0275\u0275InputFlags.SignalBased,"clearIfNotMatch"],validation:[c.\u0275\u0275InputFlags.SignalBased,"validation"],separatorLimit:[c.\u0275\u0275InputFlags.SignalBased,"separatorLimit"],allowNegativeNumbers:[c.\u0275\u0275InputFlags.SignalBased,"allowNegativeNumbers"],leadZeroDateTime:[c.\u0275\u0275InputFlags.SignalBased,"leadZeroDateTime"],leadZero:[c.\u0275\u0275InputFlags.SignalBased,"leadZero"],triggerOnMaskChange:[c.\u0275\u0275InputFlags.SignalBased,"triggerOnMaskChange"],apm:[c.\u0275\u0275InputFlags.SignalBased,"apm"],inputTransformFn:[c.\u0275\u0275InputFlags.SignalBased,"inputTransformFn"],outputTransformFn:[c.\u0275\u0275InputFlags.SignalBased,"outputTransformFn"],keepCharacterPositions:[c.\u0275\u0275InputFlags.SignalBased,"keepCharacterPositions"],instantPrefix:[c.\u0275\u0275InputFlags.SignalBased,"instantPrefix"]},outputs:{maskFilled:"maskFilled"},exportAs:["mask","ngxMask"],standalone:!0,features:[c.\u0275\u0275ProvidersFeature([{provide:F.NG_VALUE_ACCESSOR,useExisting:o,multi:!0},{provide:F.NG_VALIDATORS,useExisting:o,multi:!0},L]),c.\u0275\u0275NgOnChangesFeature]})}return o})(),re=(()=>{class o{defaultOptions=(0,c.inject)(I);_maskService=(0,c.inject)(L);_maskExpressionArray=(0,c.signal)([]);_mask=(0,c.signal)("");transform(t,e,{patterns:r,...s}={}){let n=t;const u={maskExpression:e,...this.defaultOptions,...s,patterns:{...this._maskService.patterns,...r}};if(Object.entries(u).forEach(([l,h])=>{this._maskService[l]=h}),e.includes("||")){const l=e.split("||");return l.length>1?(this._maskExpressionArray.set(l.sort((h,f)=>h.length-f.length)),this._setMask(n),this._maskService.applyMask(`${n}`,this._mask())):(this._maskExpressionArray.set([]),this._maskService.applyMask(`${n}`,this._mask()))}if(e.includes(i.CURLY_BRACKETS_LEFT))return this._maskService.applyMask(`${n}`,this._maskService._repeatPatternSymbols(e));if(e.startsWith(i.SEPARATOR)){s.decimalMarker&&(this._maskService.decimalMarker=s.decimalMarker),s.thousandSeparator&&(this._maskService.thousandSeparator=s.thousandSeparator),s.leadZero&&(this._maskService.leadZero=s.leadZero),n=String(n);const l=this._maskService.currentLocaleDecimalMarker();Array.isArray(this._maskService.decimalMarker)||(n=this._maskService.decimalMarker!==l?n.replace(l,this._maskService.decimalMarker):n),this._maskService.leadZero&&n&&!1!==this._maskService.dropSpecialCharacters&&(n=this._maskService._checkPrecision(e,n)),this._maskService.decimalMarker===i.COMMA&&(n=n.replace(i.DOT,i.COMMA)),this._maskService.isNumberValue=!0}return this._maskService.applyMask(null===n||typeof n>"u"?"":`${n}`,e)}_setMask(t){this._maskExpressionArray().length>0&&this._maskExpressionArray().some(e=>{const r=this._maskService.removeMask(t)?.length<=this._maskService.removeMask(e)?.length;if(t&&r)return this._mask.set(e),r;{const s=this._maskExpressionArray()[this._maskExpressionArray.length-1]??i.EMPTY_STRING;this._mask.set(s)}})}static \u0275fac=function(e){return new(e||o)};static \u0275pipe=c.\u0275\u0275definePipe({name:"mask",type:o,pure:!0,standalone:!0})}return o})()},467:(ee,Z,A)=>{function j(H,F,i,I,x,w,b){try{var V=H[w](b),P=V.value}catch(Q){return void i(Q)}V.done?F(P):Promise.resolve(P).then(I,x)}function c(H){return function(){var F=this,i=arguments;return new Promise(function(I,x){var w=H.apply(F,i);function b(P){j(w,I,x,b,V,"next",P)}function V(P){j(w,I,x,b,V,"throw",P)}b(void 0)})}}A.d(Z,{A:()=>c})}}]);
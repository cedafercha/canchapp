(self.webpackChunkmf_booking=self.webpackChunkmf_booking||[]).push([[846],{8846:(se,de,s)=>{var p=s(63),e=s(3274),v=s(3636);let x=(()=>{class o{constructor(){this.title="mf-booking"}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-root"]],decls:3,vars:0,template:function(n,i){1&n&&(e.\u0275\u0275elementStart(0,"h1"),e.\u0275\u0275text(1,"Booking!!!"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(2,"router-outlet"))},dependencies:[v.RouterOutlet]})}}return o})();var c=s(8648),C=s(30),B=s(5117),k=s.n(B),w=s(9157),T=s.n(w),I=s(3089),_=s.n(I),a=s(6762),u=s(1522),r=s(8883);class g{constructor(){this.text="",this.args=""}}class h extends g{}class f{constructor(){this.idBooking=-1,this.dateTimeStart=new Date,this.dateTimeEnd=new Date,this.dateTimeStartNew=new Date,this.dateTimeEndNew=new Date,this.court=new h,this.observation="",this.isRecurrent=!1,this.paymentType=r.PaymentTypeEnum.None,this.paymentStatus=r.PaymentStatusEnum.Pending,this.timeStart="",this.timeEnd="",this.day=0,this.valueCourt=0,this.totalValue=0,this.totalHours=0,this.hours=0}}var S=s(4866),E=s(6306);let b=(()=>{class o{constructor(t){this.http=t,this.apiUrl=r.ApiEnum.Booking,this.apiUrlCustomer=r.ApiEnum.Customer}create(t){return this.http.post(`${this.apiUrl}Create`,t)}createCustomer(t){return this.http.post(`${this.apiUrlCustomer}QuickCreate`,t)}getEvents(t){return this.http.get(`${this.apiUrl}GetEvents/${t}`)}update(t){return this.http.put(`${this.apiUrl}Update`,t)}delete(t){return this.http.delete(`${this.apiUrl}Delete/${t}`)}updatePay(t){return this.http.put(`${this.apiUrl}UpdatePay`,t)}getCourtValue(t,n,i,l){return this.http.get(`${this.apiUrl}GetCourtValue/${t}/${n}/${i}/${l}`)}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275inject(E.HttpClient))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function N(o,d){1&o&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function M(o,d){if(1&o&&(e.\u0275\u0275elementStart(0,"div",37),e.\u0275\u0275template(1,N,3,3,"small",38),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",null==t.formEvent.controls.timeStart||null==t.formEvent.controls.timeStart.errors?null:t.formEvent.controls.timeStart.errors.required)}}function D(o,d){1&o&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function V(o,d){if(1&o&&(e.\u0275\u0275elementStart(0,"div",37),e.\u0275\u0275template(1,D,3,3,"small",38),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",null==t.formEvent.controls.timeEnd||null==t.formEvent.controls.timeEnd.errors?null:t.formEvent.controls.timeEnd.errors.required)}}function A(o,d){1&o&&(e.\u0275\u0275elementStart(0,"div",37)(1,"small"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,1,"Booking.StartTimeMustBeGreater")))}function F(o,d){if(1&o&&(e.\u0275\u0275elementStart(0,"div",3)(1,"label",5)(2,"b"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",31)(6,"div",32)(7,"div",33)(8,"a",8),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"date"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"div",34),e.\u0275\u0275element(12,"input",35),e.\u0275\u0275template(13,M,2,1,"div",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",34),e.\u0275\u0275element(15,"input",36),e.\u0275\u0275template(16,V,2,1,"div",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(17,A,4,3,"div",14),e.\u0275\u0275elementEnd()()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,5,"Booking.DateTimeReservationNew")),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(10,7,t.eventEdit.dateTimeStartNew,"yyyy - MM - dd")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",(null==t.formEvent.controls.timeStart?null:t.formEvent.controls.timeStart.invalid)&&(null==t.formEvent.controls.timeStart?null:t.formEvent.controls.timeStart.touched)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",(null==t.formEvent.controls.timeEnd?null:t.formEvent.controls.timeEnd.invalid)&&(null==t.formEvent.controls.timeEnd?null:t.formEvent.controls.timeEnd.touched)),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",null==t.formEvent.errors?null:t.formEvent.errors.invalidTimeOrder)}}function j(o,d){1&o&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function P(o,d){if(1&o&&(e.\u0275\u0275elementStart(0,"div",37),e.\u0275\u0275template(1,j,3,3,"small",38),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",null==t.formEvent.controls.customer||null==t.formEvent.controls.customer.errors?null:t.formEvent.controls.customer.errors.required)}}function R(o,d){1&o&&(e.\u0275\u0275elementStart(0,"div",11)(1,"label",39),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"select",40,0)(6,"option",41),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"option",42),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"option",43),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"option",44),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"translate"),e.\u0275\u0275elementEnd()()()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,5,"Booking.PaymentType")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(8,7,"Select.SelectOption")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(11,9,"Booking.Cash")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(14,11,"Booking.TDebit")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(17,13,"Booking.TCredit")))}let O=(()=>{class o{constructor(t,n,i){this.formBuilder=t,this.bookingService=n,this.commonsLibService=i,this.subscription=new S.Subscription,this.formEvent=new a.FormGroup({}),this.msgSave="",this.eventEdit=new f,this.actionState=r.ActionEnum.None,this.onAddCustomer=new e.EventEmitter,this.browserId=r.BrowserIdEnum.BrowserCustomer,this.selectId=r.SelectIdEnum.ListCourt}ngOnInit(){this.formEvent=this.formBuilder.group({dateTimeStart:[""],dateTimeEnd:[""],dateTimeStartNew:[""],dateTimeEndNew:[""],timeStart:["",[a.Validators.required]],timeEnd:["",[a.Validators.required]],customer:["",[a.Validators.required]],court:[],isRecurrent:[!1],observation:[""],paymentType:["0"],valueCourt:["0"],totalValue:["0"]})}formatTime(t){return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`}ngOnChanges(t){t.actionState&&this.handleActionStateChange(t.actionState.currentValue)}handleActionStateChange(t){this.formEvent.enable(),this.actionState==r.ActionEnum.Edit&&(this.formEvent.disable(),this.formEvent.controls.observation.enable(),this.formEvent.controls.timeStart.enable(),this.formEvent.controls.timeEnd.enable())}get autocompleteCustomer(){return this.formEvent.get("customer")}get selectCourt(){return this.formEvent.get("court")}getEvent(){if(this.formEvent.markAllAsTouched(),this.formEvent.valid){let t=this.formEvent.getRawValue();return t.idBooking=this.eventEdit.idBooking,t.paymentType=Number(t.paymentType),this.actionState==r.ActionEnum.Edit&&(t.dateTimeStart=this.commonsLibService.getFormatIsoDate(t.dateTimeStartNew,t.timeStart),t.dateTimeEnd=this.commonsLibService.getFormatIsoDate(t.dateTimeEndNew,t.timeEnd)),t}return null}loadEvent(t){this.eventEdit=t,this.getPrice(),this.formEvent.patchValue(t);const n=this.formatTime(new Date(this.eventEdit.dateTimeStartNew)),i=this.formatTime(new Date(this.eventEdit.dateTimeEndNew));this.formEvent.get("timeStart")?.setValue(n),this.formEvent.get("timeEnd")?.setValue(i)}getPrice(){const t=this.commonsLibService.getTime(this.eventEdit.dateTimeStart),n=this.commonsLibService.getTime(this.eventEdit.dateTimeEnd);this.subscription.add(this.bookingService.getCourtValue(this.eventEdit.day,t,n,this.eventEdit.court.id).subscribe({next:i=>{this.eventEdit.valueCourt=i.value,this.eventEdit.totalValue=i.totalValue,this.eventEdit.totalHours=i.totalHours,this.eventEdit.hours=i.hours,this.formEvent.controls.valueCourt.setValue(i.value),this.formEvent.controls.totalValue.setValue(i.totalValue)},error:i=>{console.error(i)}}))}clicItemSelected(t){this.onAddCustomer.emit(!0)}setCustomer(t){this.formEvent.controls.customer.setValue({id:t.idCustomer,text:t.name,args:t})}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(a.FormBuilder),e.\u0275\u0275directiveInject(b),e.\u0275\u0275directiveInject(r.CommonsLibService))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-event"]],inputs:{actionState:"actionState"},outputs:{onAddCustomer:"onAddCustomer"},standalone:!0,features:[e.\u0275\u0275NgOnChangesFeature,e.\u0275\u0275StandaloneFeature],decls:66,vars:47,consts:[["paymentType",""],[3,"formGroup"],[1,"row"],[1,"col-6"],[1,"mb-4"],[1,"form-label"],[1,"nav","nav-pills","nav-primary"],[1,"nav-item"],["href","#",1,"nav-link","disabled"],["class","col-6",4,"ngIf"],[1,"col-7"],[1,"mb-3"],["for","CustomerBooking",1,"form-label"],["formControlName","customer",3,"onItemSelected","browserId","addItem"],["class","text-danger",4,"ngIf"],[1,"mb-2"],["for","observation"],["formControlName","observation","id","observation","rows","4",1,"form-control"],[1,"form-check","form-switch",3,"title"],["formControlName","isRecurrent","type","checkbox","role","switch","id","flexSwitchCheckDefault","aria-checked","false",1,"form-check-input"],["for","flexSwitchCheckDefault",1,"form-check-label"],[1,"col-5"],[1,"card","card-stats","card-info","card-round"],[1,"card-body"],[1,"icon-big","text-center"],[1,"fa-solid","fa-hand-holding-dollar","icon-large"],[1,"col-7","col-stats"],[1,"numbers"],[1,"card-category"],[1,"card-footer"],["class","mb-3",4,"ngIf"],[1,"container"],[1,"row","align-items-center"],[1,"col-12","col-md-4"],[1,"col-12","col-md-4","p-0"],["type","time","formControlName","timeStart","id","timeStart",1,"form-control","w-100"],["type","time","formControlName","timeEnd","id","timeEnd",1,"form-control","w-100"],[1,"text-danger"],[4,"ngIf"],["for","paymentType",1,"form-label"],["id","paymentType","formControlName","paymentType",1,"form-select"],["value","0"],["value","1"],["value","2"],["value","3"]],template:function(n,i){1&n&&(e.\u0275\u0275elementStart(0,"form",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"label",5),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div")(8,"ul",6)(9,"li",7)(10,"a",8),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"date"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(13,"li",7)(14,"a",8),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"date"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"li",7)(18,"a",8),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"date"),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275template(21,F,18,10,"div",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"div",2)(23,"div",10)(24,"div",11)(25,"label",12),e.\u0275\u0275text(26),e.\u0275\u0275pipe(27,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"lib-browser",13),e.\u0275\u0275listener("onItemSelected",function(m){return i.clicItemSelected(m)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(29,P,2,1,"div",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"div",15)(31,"label",16),e.\u0275\u0275text(32),e.\u0275\u0275pipe(33,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(34,"textarea",17),e.\u0275\u0275text(35," "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(36,"div")(37,"div",18),e.\u0275\u0275pipe(38,"translate"),e.\u0275\u0275element(39,"input",19),e.\u0275\u0275elementStart(40,"label",20),e.\u0275\u0275text(41),e.\u0275\u0275pipe(42,"translate"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(43,"div",21)(44,"div",22)(45,"div",23)(46,"div",2)(47,"div",21)(48,"div",24),e.\u0275\u0275element(49,"i",25),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(50,"div",26)(51,"div",27)(52,"p",28),e.\u0275\u0275text(53),e.\u0275\u0275pipe(54,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(55,"h1"),e.\u0275\u0275text(56),e.\u0275\u0275pipe(57,"number"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(58,"div",29)(59,"div"),e.\u0275\u0275text(60),e.\u0275\u0275pipe(61,"translate"),e.\u0275\u0275elementStart(62,"strong"),e.\u0275\u0275text(63),e.\u0275\u0275pipe(64,"number"),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275template(65,R,18,15,"div",30),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275property("formGroup",i.formEvent),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,18,"Booking.DateTimeReservation")),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(12,20,i.eventEdit.dateTimeStart,"yyyy - MM - dd")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(16,23,i.eventEdit.dateTimeStart,"h : mm a")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(20,26,i.eventEdit.dateTimeEnd,"h : mm a")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",2==i.actionState),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(27,29,"Booking.CustomerBooking")),e.\u0275\u0275advance(2),e.\u0275\u0275property("browserId",i.browserId)("addItem",!0),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",(null==i.formEvent.controls.customer?null:i.formEvent.controls.customer.invalid)&&(null==i.formEvent.controls.customer?null:i.formEvent.controls.customer.touched)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(33,31,"Booking.Comment")),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("title",e.\u0275\u0275pipeBind1(38,33,"Tooltip.RecurringBooking")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(42,35,"Booking.IsRecurringBooking")),e.\u0275\u0275advance(12),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(54,37,"Booking.TotalValue")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("$ ",e.\u0275\u0275pipeBind2(57,39,i.eventEdit.totalValue,"1.0-0"),""),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(61,42,"Booking.HourValue"),": "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("$ ",e.\u0275\u0275pipeBind2(64,44,i.eventEdit.valueCourt,"1.0-0"),""),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",3==i.actionState))},dependencies:[c.CommonModule,c.NgIf,c.DecimalPipe,c.DatePipe,u.TranslateModule,u.TranslatePipe,a.ReactiveFormsModule,a.\u0275NgNoValidate,a.NgSelectOption,a.\u0275NgSelectMultipleOption,a.DefaultValueAccessor,a.CheckboxControlValueAccessor,a.SelectControlValueAccessor,a.NgControlStatus,a.NgControlStatusGroup,a.FormGroupDirective,a.FormControlName,r.BrowserComponent],styles:[".ui-datepicker[_ngcontent-%COMP%]{z-index:1051!important}.icon-large[_ngcontent-%COMP%]{font-size:55px}"]})}}return o})();class ${constructor(){this.dateTimeStart=new Date,this.dateTimeEnd=new Date,this.idCourt=-1,this.paymentStatus=r.PaymentStatusEnum.Pending,this.paymentType=r.PaymentTypeEnum.None,this.isRecurrent=!1,this.observation="",this.dateCreated=(new Date).toISOString(),this.dateUpdated=(new Date).toISOString(),this.valueCourt=0,this.totalValue=0}}class G extends g{}function H(o,d){1&o&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function Q(o,d){if(1&o&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275template(1,H,3,3,"small",9),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",null==t.formCustomer.controls.name||null==t.formCustomer.controls.name.errors?null:t.formCustomer.controls.name.errors.required)}}function L(o,d){1&o&&(e.\u0275\u0275elementStart(0,"small"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function U(o,d){if(1&o&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275template(1,L,3,3,"small",9),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",null==t.formCustomer.controls.phone||null==t.formCustomer.controls.phone.errors?null:t.formCustomer.controls.phone.errors.required)}}let q=(()=>{class o{constructor(t,n){this.translate=t,this.formBuilder=n,this.formCustomer=new a.FormGroup({})}ngOnInit(){this.formCustomer=this.formBuilder.group({name:["",[a.Validators.required]],phone:["",[a.Validators.required]]})}getCustomer(){return this.formCustomer.markAllAsTouched(),this.formCustomer.valid?this.formCustomer.getRawValue():null}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(u.TranslateService),e.\u0275\u0275directiveInject(a.FormBuilder))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-new-customer"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:15,vars:9,consts:[[3,"formGroup"],[1,"row"],[1,"col"],["for","name",1,"form-label"],["type","text","formControlName","name","id","name",1,"form-control"],["class","text-danger",4,"ngIf"],["for","phone",1,"form-label"],["type","text","formControlName","phone","id","phone",1,"form-control"],[1,"text-danger"],[4,"ngIf"]],template:function(n,i){1&n&&(e.\u0275\u0275elementStart(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"input",4),e.\u0275\u0275template(7,Q,2,1,"div",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"div",1)(9,"div",2)(10,"label",6),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"input",7),e.\u0275\u0275template(14,U,2,1,"div",5),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275property("formGroup",i.formCustomer),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,5,"Booking.NameCustomer")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",(null==i.formCustomer.controls.name?null:i.formCustomer.controls.name.invalid)&&(null==i.formCustomer.controls.name?null:i.formCustomer.controls.name.touched)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(12,7,"Booking.PhoneCustomer")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",(null==i.formCustomer.controls.phone?null:i.formCustomer.controls.phone.invalid)&&(null==i.formCustomer.controls.phone?null:i.formCustomer.controls.phone.touched)))},dependencies:[c.CommonModule,c.NgIf,u.TranslateModule,u.TranslatePipe,a.ReactiveFormsModule,a.\u0275NgNoValidate,a.DefaultValueAccessor,a.NgControlStatus,a.NgControlStatusGroup,a.FormGroupDirective,a.FormControlName]})}}return o})(),Y=(()=>{class o{constructor(t){this.http=t,this.apiUrl=r.ApiEnum.HoliDay}getHoliDays(t){return this.http.get(`${this.apiUrl}GetHoliDayByYear/${t}`)}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275inject(E.HttpClient))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();const z=["calendar"],W=["appEvent"],Z=["appNewCustomer"],J=["eventModal"],K=["eventConfirmModal"],X=["eventAddCustomerModal"];function ee(o,d){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.saveEvent())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()}2&o&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Button.Save")))}function te(o,d){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.updateEvent())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()}2&o&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Button.Edit")))}function ne(o,d){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",30),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.showEventConfirmModal())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()}2&o&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Button.Delete")))}let oe=(()=>{class o{constructor(t,n,i,l){this.translate=t,this.bookingService=n,this.holiDayService=i,this.notificationService=l,this.subscription=new S.Subscription,this.initialLocaleCode="es",this.disabledDays=[],this.actionState=r.ActionEnum.None,this.courtNameSelected="",this.courtIdSelected=-1,this.calendarOptions={plugins:[T(),k(),_()],initialView:"timeGridWeek",locale:this.initialLocaleCode,allDaySlot:!1,selectable:!0,selectMirror:!0,editable:!0,select:m=>{this.handleSelect(m)},selectAllow:m=>this.handleSelectAllow(m),datesSet:m=>this.handleDatesSet(m),eventDrop:m=>this.handleEventDrop(m),eventClick:m=>this.handleEventClick(m),headerToolbar:{left:"prev,next,today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},slotLabelFormat:[{hour12:!0,hour:"numeric",minute:"2-digit"}],buttonText:{today:"Hoy",month:"Mes",week:"Semana",day:"D\xeda"},dayHeaderFormat:{weekday:"long",day:"numeric"}},this.titleModal="",this.selectId=r.SelectIdEnum.ListCourt}ngOnInit(){this.loadEvents(-1)}ngAfterViewInit(){this.eventModal=new bootstrap.Modal(this.modalElement.nativeElement),this.eventConfirmModal=new bootstrap.Modal(this.modalConfirmElement.nativeElement),this.eventAddCustomerModal=new bootstrap.Modal(this.modalAddCustomer.nativeElement),this.modalElement.nativeElement.addEventListener("hidden.bs.modal",()=>{this.actionState=r.ActionEnum.None,this.loadEvents(-1)})}loadEvents(t){this.subscription.add(this.bookingService.getEvents(t).subscribe(n=>{this.disabledDays=[],this.calendarOptions.events=n.map(i=>({id:i.idBooking.toString(),title:i.nameCustomer,start:i.dateTimeStart,end:i.dateTimeEnd,backgroundColor:i.color,borderColor:i.color,extendedProps:i}))}))}loadHoliDay(t){this.subscription.add(this.holiDayService.getHoliDays(t).subscribe(n=>{this.disabledDays=[],this.disabledDays=n.map(i=>{const l=new Date(i.day);return`${l.getFullYear()}-${l.getMonth()+1}-${l.getDate()}`})}))}onChangeCourt({target:t}){"-1"!=t.value&&(this.courtIdSelected=t.value,this.courtNameSelected=t.selectedOptions[0].text,this.loadEvents(this.courtIdSelected))}handleSelectAllow(t){const n=`${t.start.getFullYear()}-${t.start.getMonth()+1}-${t.start.getDate()}`;return!this.disabledDays.includes(n)}handleSelect(t){if(-1==this.courtIdSelected)return;this.titleModal=this.translate.instant("Booking.TitleModalNew"),this.actionState=r.ActionEnum.Create;let n=new f;n.dateTimeStart=t.startStr,n.dateTimeEnd=t.endStr,n.day=t.start.getDay(),n.court=new h,n.court.id=this.courtIdSelected,this.showEventmodal(n)}handleEventDrop(t){if(!this.handleSelectAllow({start:t.event.start}))return void t.revert();this.titleModal=this.translate.instant("Booking.TitleModalEdit"),this.actionState=r.ActionEnum.Edit;let i=this.getEvent(t.event.id);i&&(i.dateTimeStartNew=t.event.startStr,i.dateTimeEndNew=t.event.endStr,this.showEventmodal(i))}handleEventClick(t){this.titleModal=this.translate.instant("Booking.TitleModalDetail"),this.actionState=r.ActionEnum.Detail;const n=this.getEvent(t.event.id);n&&this.showEventmodal(n)}handleDatesSet(t){const i=t.start.getFullYear();this.loadHoliDay(i)}getEvent(t){let n=this.calendar.getApi().getEventById(t);if(n){let i=new f;return i.idBooking=n.extendedProps.idBooking,i.dateTimeStart=n.extendedProps.dateTimeStart,i.dateTimeEnd=n.extendedProps.dateTimeEnd,i.paymentStatus=n.extendedProps.paymentStatus,i.paymentType=n.extendedProps.paymentType,i.observation=n.extendedProps.observation,i.customer=new G,i.customer.id=n.extendedProps.idCustomer,i.customer.text=n.extendedProps.nameCustomer,i.court=new h,i.court.id=n.extendedProps.idCourt,i.court.text=n.extendedProps.nameCourt,i}return null}showEventmodal(t){this.eventComponent.loadEvent(t),this.eventModal.show()}showEventConfirmModal(){this.eventModal.hide(),this.eventConfirmModal.show()}getBooking(){const t=this.eventComponent.getEvent();if(t){let n=new $;return n.idBooking=t.idBooking,n.dateTimeStart=t.dateTimeStart,n.dateTimeEnd=t.dateTimeEnd,n.idCustomer=t.customer?.id,n.idCourt=t.court.id,n.isRecurrent=t.isRecurrent,n.observation=t.observation,n.paymentType=t.paymentType,n.valueCourt=t.valueCourt,n.totalValue=t.totalValue,n}return null}saveEvent(){const t=this.getBooking();if(t){if(t.valueCourt<=0)return void this.notificationService.ErrorNotification(this.translate.instant("Error.PriceMustBeGreaterThanZero"));this.subscription.add(this.bookingService.create(t).subscribe({next:n=>{this.notificationService.SuccesNotification(this.translate.instant("Booking.BookingCreated")),this.actionState=r.ActionEnum.None,this.loadEvents(-1),this.eventModal.hide()},error:n=>{n.error?.code?n.error.code===r.CodeErrorEnum.BookingNotAvailable?this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotAvailable")):console.error("Error no manejado:",n.error.code):console.error("Error sin c\xf3digo espec\xedfico:",n.message)}}))}}updateEvent(){const t=this.getBooking();t&&this.subscription.add(this.bookingService.update(t).subscribe({next:n=>{this.notificationService.SuccesNotification(this.translate.instant("Booking.BookingCreated")),this.actionState=r.ActionEnum.None,this.loadEvents(-1),this.eventModal.hide()},error:n=>{if(n.error?.code)switch(n.error.code){case r.CodeErrorEnum.BookingNotAvailable:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotAvailable"));break;case r.CodeErrorEnum.BookingDateStartMustBeGreater:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingDateStartMustBeGreater"));break;default:console.error("Error no manejado:",n.error.code)}else console.error("Error sin c\xf3digo espec\xedfico:",n.message)}}))}deleteEvent(){const t=this.getBooking();t.idBooking&&this.subscription.add(this.bookingService.delete(t.idBooking).subscribe({next:n=>{this.notificationService.SuccesNotification(this.translate.instant("Booking.BookingCreated")),this.actionState=r.ActionEnum.None,this.loadEvents(-1),this.eventModal.hide()},error:n=>{if(n.error?.code)switch(n.error.code){case r.CodeErrorEnum.BookingNotAvailable:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotAvailable"));break;case r.CodeErrorEnum.BookingNotFound:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotFound"));break;case r.CodeErrorEnum.BookingPaid:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingPaid"));break;default:console.error("Error no manejado:",n.error.code)}else console.error("Error sin c\xf3digo espec\xedfico:",n.message)}}))}onAddCustomer(){this.eventModal.hide(),this.eventAddCustomerModal.show()}saveCustomer(){const t=this.newCustomerComponent.getCustomer();t&&this.subscription.add(this.bookingService.createCustomer(t).subscribe({next:n=>{this.notificationService.SuccesNotification(this.translate.instant("Booking.CustomerCreated")),this.actionState=r.ActionEnum.Create,this.eventAddCustomerModal.hide(),this.eventComponent.setCustomer(n),this.eventModal.show()},error:n=>{if(n.error?.code)switch(n.error.code){case r.CodeErrorEnum.BookingNotAvailable:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotAvailable"));break;case r.CodeErrorEnum.BookingNotFound:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotFound"));break;case r.CodeErrorEnum.BookingPaid:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingPaid"));break;default:console.error("Error no manejado:",n.error.code)}else console.error("Error sin c\xf3digo espec\xedfico:",n.message)}}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(n){return new(n||o)(e.\u0275\u0275directiveInject(u.TranslateService),e.\u0275\u0275directiveInject(b),e.\u0275\u0275directiveInject(Y),e.\u0275\u0275directiveInject(r.NotificationService))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-calendar"]],viewQuery:function(n,i){if(1&n&&(e.\u0275\u0275viewQuery(z,5),e.\u0275\u0275viewQuery(W,7),e.\u0275\u0275viewQuery(Z,7),e.\u0275\u0275viewQuery(J,7),e.\u0275\u0275viewQuery(K,7),e.\u0275\u0275viewQuery(X,7)),2&n){let l;e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(i.calendar=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(i.eventComponent=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(i.newCustomerComponent=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(i.modalElement=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(i.modalConfirmElement=l.first),e.\u0275\u0275queryRefresh(l=e.\u0275\u0275loadQuery())&&(i.modalAddCustomer=l.first)}},standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:65,vars:32,consts:[["calendar",""],["eventModal",""],["appEvent",""],["eventConfirmModal",""],["eventAddCustomerModal",""],["appNewCustomer",""],[1,"card"],[1,"card-body"],[1,"mb-2"],["for","Court",1,"form-label"],[3,"change","selectId"],[3,"options"],["id","eventModal","tabindex","-1","aria-labelledby","eventModalLabel",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","eventModalLabel",1,"modal-title","fs-5"],[1,"ms-3"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[3,"onAddCustomer","actionState"],[1,"modal-footer"],["type","button","class","btn btn-success",3,"click",4,"ngIf"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],["type","button","data-bs-dismiss","modal",1,"btn","btn-outline-secondary"],["tabindex","-1","role","dialog",1,"modal"],["role","document",1,"modal-dialog"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(n,i){if(1&n){const l=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6)(1,"div",7)(2,"div",8)(3,"label",9),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"lib-select",10),e.\u0275\u0275listener("change",function(le){return e.\u0275\u0275restoreView(l),e.\u0275\u0275resetView(i.onChangeCourt(le))}),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275element(7,"full-calendar",11,0),e.\u0275\u0275elementStart(9,"div",12,1)(11,"div",13)(12,"div",14)(13,"div",15)(14,"h1",16),e.\u0275\u0275text(15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"h2",17),e.\u0275\u0275text(17),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(18,"button",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"div",19)(20,"app-event",20,2),e.\u0275\u0275listener("onAddCustomer",function(){return e.\u0275\u0275restoreView(l),e.\u0275\u0275resetView(i.onAddCustomer())}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"div",21),e.\u0275\u0275template(23,ee,3,3,"button",22)(24,te,3,3,"button",22)(25,ne,3,3,"button",23),e.\u0275\u0275elementStart(26,"button",24),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(29,"div",25,3)(31,"div",26)(32,"div",14)(33,"div",15)(34,"h5",27),e.\u0275\u0275text(35,"Modal title"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(36,"div",19)(37,"p"),e.\u0275\u0275text(38),e.\u0275\u0275pipe(39,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(40,"div",21)(41,"button",28),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(l),e.\u0275\u0275resetView(i.deleteEvent())}),e.\u0275\u0275text(42),e.\u0275\u0275pipe(43,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(44,"button",24),e.\u0275\u0275text(45),e.\u0275\u0275pipe(46,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(47,"div",25,4)(49,"div",26)(50,"div",14)(51,"div",15)(52,"h5",27),e.\u0275\u0275text(53),e.\u0275\u0275pipe(54,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(55,"div",19),e.\u0275\u0275element(56,"app-new-customer",null,5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"div",21)(59,"button",28),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(l),e.\u0275\u0275resetView(i.saveCustomer())}),e.\u0275\u0275text(60),e.\u0275\u0275pipe(61,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(62,"button",24),e.\u0275\u0275text(63),e.\u0275\u0275pipe(64,"translate"),e.\u0275\u0275elementEnd()()()()()}2&n&&(e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,16,"Court.Court")),e.\u0275\u0275advance(2),e.\u0275\u0275property("selectId",i.selectId),e.\u0275\u0275advance(),e.\u0275\u0275property("options",i.calendarOptions),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate(i.titleModal),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.courtNameSelected),e.\u0275\u0275advance(3),e.\u0275\u0275property("actionState",i.actionState),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",1==i.actionState),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",3==i.actionState||2==i.actionState),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",3==i.actionState),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(28,18,"Button.Cancel")),e.\u0275\u0275advance(11),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(39,20,"Booking.ConfirmDeleteBooking")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(43,22,"Button.Yes")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(46,24,"Button.No")),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(54,26,"Booking.NewCustomer")),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(61,28,"Button.Save")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(64,30,"Button.Cancel")))},dependencies:[u.TranslateModule,u.TranslatePipe,C.FullCalendarModule,C.FullCalendarComponent,O,r.SelectComponent,c.CommonModule,c.NgIf,q]})}}return o})();const ie=[{path:"",redirectTo:"booking",pathMatch:"full"},{path:"booking",component:(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-booking"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:1,vars:0,template:function(n,i){1&n&&e.\u0275\u0275element(0,"app-calendar")},dependencies:[oe]})}}return o})()}];let y=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=e.\u0275\u0275defineNgModule({type:o})}static{this.\u0275inj=e.\u0275\u0275defineInjector({imports:[v.RouterModule.forChild(ie),v.RouterModule]})}}return o})(),re=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=e.\u0275\u0275defineNgModule({type:o})}static{this.\u0275inj=e.\u0275\u0275defineInjector({imports:[c.CommonModule,y]})}}return o})(),ae=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=e.\u0275\u0275defineNgModule({type:o,bootstrap:[x]})}static{this.\u0275inj=e.\u0275\u0275defineInjector({providers:[(0,p.provideClientHydration)()],imports:[p.BrowserModule,c.CommonModule,y,E.HttpClientModule,re]})}}return o})();p.platformBrowser().bootstrapModule(ae).catch(o=>console.error(o))}}]);
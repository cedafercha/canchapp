(self.webpackChunkmf_booking=self.webpackChunkmf_booking||[]).push([[72],{5465:(T,E,n)=>{n.d(E,{u:()=>a});var s=n(3636),t=n(122),C=n(3274);const O=[{path:"",redirectTo:"booking",pathMatch:"full"},{path:"booking",component:t.W}];let a=(()=>{class p{static{this.\u0275fac=function(I){return new(I||p)}}static{this.\u0275mod=C.\u0275\u0275defineNgModule({type:p})}static{this.\u0275inj=C.\u0275\u0275defineInjector({imports:[s.RouterModule.forChild(O),s.RouterModule]})}}return p})()},9072:(T,E,n)=>{n.r(E),n.d(E,{BookingModule:()=>O});var s=n(8648),t=n(5465),C=n(3274);let O=(()=>{class a{static{this.\u0275fac=function(u){return new(u||a)}}static{this.\u0275mod=C.\u0275\u0275defineNgModule({type:a})}static{this.\u0275inj=C.\u0275\u0275defineInjector({imports:[s.CommonModule,t.u]})}}return a})()},9784:(T,E,n)=>{n.d(E,{S:()=>G});var s=n(30),t=n(5117),C=n.n(t),d=n(9157),O=n.n(d),a=n(3089),p=n.n(a),g=n(7418),u=n(1522),y=n(2977),x=n(5326),h=n(4866),m=n(8883),S=n(2419),L=n(9686),R=n(8648),U=n(7810),e=n(3274),c=n(8970),P=n(2857);const l=["calendar"],M=["appEvent"],_=["appNewCustomer"],k=["eventModal"],N=["eventConfirmModal"],V=["eventAddCustomerModal"];function F(D,w){if(1&D){const r=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(r);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.saveEvent())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()}2&D&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Button.Save")))}function j(D,w){if(1&D){const r=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(r);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.updateEvent())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()}2&D&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Button.Edit")))}function $(D,w){if(1&D){const r=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",30),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(r);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.showEventConfirmModal())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()}2&D&&(e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Button.Delete")))}let G=(()=>{class D{constructor(r,o,i,v){this.translate=r,this.bookingService=o,this.holiDayService=i,this.notificationService=v,this.subscription=new h.Subscription,this.initialLocaleCode="es",this.disabledDays=[],this.actionState=m.ActionEnum.None,this.courtNameSelected="",this.courtIdSelected=-1,this.calendarOptions={plugins:[O(),C(),p()],initialView:"timeGridWeek",locale:this.initialLocaleCode,allDaySlot:!1,selectable:!0,selectMirror:!0,editable:!0,select:B=>{this.handleSelect(B)},selectAllow:B=>this.handleSelectAllow(B),datesSet:B=>this.handleDatesSet(B),eventDrop:B=>this.handleEventDrop(B),eventClick:B=>this.handleEventClick(B),headerToolbar:{left:"prev,next,today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},slotLabelFormat:[{hour12:!0,hour:"numeric",minute:"2-digit"}],buttonText:{today:"Hoy",month:"Mes",week:"Semana",day:"D\xeda"},dayHeaderFormat:{weekday:"long",day:"numeric"}},this.titleModal="",this.selectId=m.SelectIdEnum.ListCourt}ngOnInit(){this.loadEvents(-1)}ngAfterViewInit(){this.eventModal=new bootstrap.Modal(this.modalElement.nativeElement),this.eventConfirmModal=new bootstrap.Modal(this.modalConfirmElement.nativeElement),this.eventAddCustomerModal=new bootstrap.Modal(this.modalAddCustomer.nativeElement),this.modalElement.nativeElement.addEventListener("hidden.bs.modal",()=>{this.actionState=m.ActionEnum.None,this.loadEvents(-1)})}loadEvents(r){this.subscription.add(this.bookingService.getEvents(r).subscribe(o=>{this.disabledDays=[],this.calendarOptions.events=o.map(i=>({id:i.idBooking.toString(),title:i.nameCustomer,start:i.dateTimeStart,end:i.dateTimeEnd,backgroundColor:i.color,borderColor:i.color,extendedProps:i}))}))}loadHoliDay(r){this.subscription.add(this.holiDayService.getHoliDays(r).subscribe(o=>{this.disabledDays=[],this.disabledDays=o.map(i=>{const v=new Date(i.day);return`${v.getFullYear()}-${v.getMonth()+1}-${v.getDate()}`})}))}onChangeCourt({target:r}){"-1"!=r.value&&(this.courtIdSelected=r.value,this.courtNameSelected=r.selectedOptions[0].text,this.loadEvents(this.courtIdSelected))}handleSelectAllow(r){const o=`${r.start.getFullYear()}-${r.start.getMonth()+1}-${r.start.getDate()}`;return!this.disabledDays.includes(o)}handleSelect(r){if(-1==this.courtIdSelected)return;this.titleModal=this.translate.instant("Booking.TitleModalNew"),this.actionState=m.ActionEnum.Create;let o=new y.k;o.dateTimeStart=r.startStr,o.dateTimeEnd=r.endStr,o.day=r.start.getDay(),o.court=new L.f,o.court.id=this.courtIdSelected,this.showEventmodal(o)}handleEventDrop(r){if(!this.handleSelectAllow({start:r.event.start}))return void r.revert();this.titleModal=this.translate.instant("Booking.TitleModalEdit"),this.actionState=m.ActionEnum.Edit;let i=this.getEvent(r.event.id);i&&(i.dateTimeStartNew=r.event.startStr,i.dateTimeEndNew=r.event.endStr,this.showEventmodal(i))}handleEventClick(r){this.titleModal=this.translate.instant("Booking.TitleModalDetail"),this.actionState=m.ActionEnum.Detail;const o=this.getEvent(r.event.id);o&&this.showEventmodal(o)}handleDatesSet(r){const i=r.start.getFullYear();this.loadHoliDay(i)}getEvent(r){let o=this.calendar.getApi().getEventById(r);if(o){let i=new y.k;return i.idBooking=o.extendedProps.idBooking,i.dateTimeStart=o.extendedProps.dateTimeStart,i.dateTimeEnd=o.extendedProps.dateTimeEnd,i.paymentStatus=o.extendedProps.paymentStatus,i.paymentType=o.extendedProps.paymentType,i.observation=o.extendedProps.observation,i.customer=new S.m,i.customer.id=o.extendedProps.idCustomer,i.customer.text=o.extendedProps.nameCustomer,i.court=new L.f,i.court.id=o.extendedProps.idCourt,i.court.text=o.extendedProps.nameCourt,i}return null}showEventmodal(r){this.eventComponent.loadEvent(r),this.eventModal.show()}showEventConfirmModal(){this.eventModal.hide(),this.eventConfirmModal.show()}getBooking(){const r=this.eventComponent.getEvent();if(r){let o=new x.H;return o.idBooking=r.idBooking,o.dateTimeStart=r.dateTimeStart,o.dateTimeEnd=r.dateTimeEnd,o.idCustomer=r.customer?.id,o.idCourt=r.court.id,o.isRecurrent=r.isRecurrent,o.observation=r.observation,o.paymentType=r.paymentType,o.valueCourt=r.valueCourt,o.totalValue=r.totalValue,o}return null}saveEvent(){const r=this.getBooking();if(r){if(r.valueCourt<=0)return void this.notificationService.ErrorNotification(this.translate.instant("Error.PriceMustBeGreaterThanZero"));this.subscription.add(this.bookingService.create(r).subscribe({next:o=>{this.notificationService.SuccesNotification(this.translate.instant("Booking.BookingCreated")),this.actionState=m.ActionEnum.None,this.loadEvents(-1),this.eventModal.hide()},error:o=>{o.error?.code?o.error.code===m.CodeErrorEnum.BookingNotAvailable?this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotAvailable")):console.error("Error no manejado:",o.error.code):console.error("Error sin c\xf3digo espec\xedfico:",o.message)}}))}}updateEvent(){const r=this.getBooking();r&&this.subscription.add(this.bookingService.update(r).subscribe({next:o=>{this.notificationService.SuccesNotification(this.translate.instant("Booking.BookingCreated")),this.actionState=m.ActionEnum.None,this.loadEvents(-1),this.eventModal.hide()},error:o=>{if(o.error?.code)switch(o.error.code){case m.CodeErrorEnum.BookingNotAvailable:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotAvailable"));break;case m.CodeErrorEnum.BookingDateStartMustBeGreater:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingDateStartMustBeGreater"));break;default:console.error("Error no manejado:",o.error.code)}else console.error("Error sin c\xf3digo espec\xedfico:",o.message)}}))}deleteEvent(){const r=this.getBooking();r.idBooking&&this.subscription.add(this.bookingService.delete(r.idBooking).subscribe({next:o=>{this.notificationService.SuccesNotification(this.translate.instant("Booking.BookingCreated")),this.actionState=m.ActionEnum.None,this.loadEvents(-1),this.eventModal.hide()},error:o=>{if(o.error?.code)switch(o.error.code){case m.CodeErrorEnum.BookingNotAvailable:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotAvailable"));break;case m.CodeErrorEnum.BookingNotFound:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotFound"));break;case m.CodeErrorEnum.BookingPaid:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingPaid"));break;default:console.error("Error no manejado:",o.error.code)}else console.error("Error sin c\xf3digo espec\xedfico:",o.message)}}))}onAddCustomer(){this.eventModal.hide(),this.eventAddCustomerModal.show()}saveCustomer(){const r=this.newCustomerComponent.getCustomer();r&&this.subscription.add(this.bookingService.createCustomer(r).subscribe({next:o=>{this.notificationService.SuccesNotification(this.translate.instant("Booking.CustomerCreated")),this.actionState=m.ActionEnum.Create,this.eventAddCustomerModal.hide(),this.eventComponent.setCustomer(o),this.eventModal.show()},error:o=>{if(o.error?.code)switch(o.error.code){case m.CodeErrorEnum.BookingNotAvailable:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotAvailable"));break;case m.CodeErrorEnum.BookingNotFound:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingNotFound"));break;case m.CodeErrorEnum.BookingPaid:this.notificationService.ErrorNotification(this.translate.instant("Error.BookingPaid"));break;default:console.error("Error no manejado:",o.error.code)}else console.error("Error sin c\xf3digo espec\xedfico:",o.message)}}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(o){return new(o||D)(e.\u0275\u0275directiveInject(u.TranslateService),e.\u0275\u0275directiveInject(c.L),e.\u0275\u0275directiveInject(P.Q),e.\u0275\u0275directiveInject(m.NotificationService))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:D,selectors:[["app-calendar"]],viewQuery:function(o,i){if(1&o&&(e.\u0275\u0275viewQuery(l,5),e.\u0275\u0275viewQuery(M,7),e.\u0275\u0275viewQuery(_,7),e.\u0275\u0275viewQuery(k,7),e.\u0275\u0275viewQuery(N,7),e.\u0275\u0275viewQuery(V,7)),2&o){let v;e.\u0275\u0275queryRefresh(v=e.\u0275\u0275loadQuery())&&(i.calendar=v.first),e.\u0275\u0275queryRefresh(v=e.\u0275\u0275loadQuery())&&(i.eventComponent=v.first),e.\u0275\u0275queryRefresh(v=e.\u0275\u0275loadQuery())&&(i.newCustomerComponent=v.first),e.\u0275\u0275queryRefresh(v=e.\u0275\u0275loadQuery())&&(i.modalElement=v.first),e.\u0275\u0275queryRefresh(v=e.\u0275\u0275loadQuery())&&(i.modalConfirmElement=v.first),e.\u0275\u0275queryRefresh(v=e.\u0275\u0275loadQuery())&&(i.modalAddCustomer=v.first)}},standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:65,vars:32,consts:[["calendar",""],["eventModal",""],["appEvent",""],["eventConfirmModal",""],["eventAddCustomerModal",""],["appNewCustomer",""],[1,"card"],[1,"card-body"],[1,"mb-2"],["for","Court",1,"form-label"],[3,"change","selectId"],[3,"options"],["id","eventModal","tabindex","-1","aria-labelledby","eventModalLabel",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","eventModalLabel",1,"modal-title","fs-5"],[1,"ms-3"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[3,"onAddCustomer","actionState"],[1,"modal-footer"],["type","button","class","btn btn-success",3,"click",4,"ngIf"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],["type","button","data-bs-dismiss","modal",1,"btn","btn-outline-secondary"],["tabindex","-1","role","dialog",1,"modal"],["role","document",1,"modal-dialog"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(o,i){if(1&o){const v=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6)(1,"div",7)(2,"div",8)(3,"label",9),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"lib-select",10),e.\u0275\u0275listener("change",function(H){return e.\u0275\u0275restoreView(v),e.\u0275\u0275resetView(i.onChangeCourt(H))}),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275element(7,"full-calendar",11,0),e.\u0275\u0275elementStart(9,"div",12,1)(11,"div",13)(12,"div",14)(13,"div",15)(14,"h1",16),e.\u0275\u0275text(15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"h2",17),e.\u0275\u0275text(17),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(18,"button",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"div",19)(20,"app-event",20,2),e.\u0275\u0275listener("onAddCustomer",function(){return e.\u0275\u0275restoreView(v),e.\u0275\u0275resetView(i.onAddCustomer())}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"div",21),e.\u0275\u0275template(23,F,3,3,"button",22)(24,j,3,3,"button",22)(25,$,3,3,"button",23),e.\u0275\u0275elementStart(26,"button",24),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(29,"div",25,3)(31,"div",26)(32,"div",14)(33,"div",15)(34,"h5",27),e.\u0275\u0275text(35,"Modal title"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(36,"div",19)(37,"p"),e.\u0275\u0275text(38),e.\u0275\u0275pipe(39,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(40,"div",21)(41,"button",28),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(v),e.\u0275\u0275resetView(i.deleteEvent())}),e.\u0275\u0275text(42),e.\u0275\u0275pipe(43,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(44,"button",24),e.\u0275\u0275text(45),e.\u0275\u0275pipe(46,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(47,"div",25,4)(49,"div",26)(50,"div",14)(51,"div",15)(52,"h5",27),e.\u0275\u0275text(53),e.\u0275\u0275pipe(54,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(55,"div",19),e.\u0275\u0275element(56,"app-new-customer",null,5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"div",21)(59,"button",28),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(v),e.\u0275\u0275resetView(i.saveCustomer())}),e.\u0275\u0275text(60),e.\u0275\u0275pipe(61,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(62,"button",24),e.\u0275\u0275text(63),e.\u0275\u0275pipe(64,"translate"),e.\u0275\u0275elementEnd()()()()()}2&o&&(e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,16,"Court.Court")),e.\u0275\u0275advance(2),e.\u0275\u0275property("selectId",i.selectId),e.\u0275\u0275advance(),e.\u0275\u0275property("options",i.calendarOptions),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate(i.titleModal),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.courtNameSelected),e.\u0275\u0275advance(3),e.\u0275\u0275property("actionState",i.actionState),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",1==i.actionState),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",3==i.actionState||2==i.actionState),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",3==i.actionState),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(28,18,"Button.Cancel")),e.\u0275\u0275advance(11),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(39,20,"Booking.ConfirmDeleteBooking")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(43,22,"Button.Yes")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(46,24,"Button.No")),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(54,26,"Booking.NewCustomer")),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(61,28,"Button.Save")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(64,30,"Button.Cancel")))},dependencies:[u.TranslateModule,u.TranslatePipe,s.FullCalendarModule,s.FullCalendarComponent,g.W,m.SelectComponent,R.CommonModule,R.NgIf,U.k]})}}return D})()},7418:(T,E,n)=>{n.d(E,{W:()=>K});var s=n(8648),t=n(3274),d=n(6762),a=n(1522),g=n(8883),I=n(2977),y=n(4866),h=n(8970);function A(c,P){1&c&&(t.\u0275\u0275elementStart(0,"small"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&c&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function m(c,P){if(1&c&&(t.\u0275\u0275elementStart(0,"div",37),t.\u0275\u0275template(1,A,3,3,"small",38),t.\u0275\u0275elementEnd()),2&c){const l=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",null==l.formEvent.controls.timeStart||null==l.formEvent.controls.timeStart.errors?null:l.formEvent.controls.timeStart.errors.required)}}function b(c,P){1&c&&(t.\u0275\u0275elementStart(0,"small"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&c&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function S(c,P){if(1&c&&(t.\u0275\u0275elementStart(0,"div",37),t.\u0275\u0275template(1,b,3,3,"small",38),t.\u0275\u0275elementEnd()),2&c){const l=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",null==l.formEvent.controls.timeEnd||null==l.formEvent.controls.timeEnd.errors?null:l.formEvent.controls.timeEnd.errors.required)}}function L(c,P){1&c&&(t.\u0275\u0275elementStart(0,"div",37)(1,"small"),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd()()),2&c&&(t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,1,"Booking.StartTimeMustBeGreater")))}function R(c,P){if(1&c&&(t.\u0275\u0275elementStart(0,"div",3)(1,"label",5)(2,"b"),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(5,"div",31)(6,"div",32)(7,"div",33)(8,"a",8),t.\u0275\u0275text(9),t.\u0275\u0275pipe(10,"date"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(11,"div",34),t.\u0275\u0275element(12,"input",35),t.\u0275\u0275template(13,m,2,1,"div",14),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"div",34),t.\u0275\u0275element(15,"input",36),t.\u0275\u0275template(16,S,2,1,"div",14),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(17,L,4,3,"div",14),t.\u0275\u0275elementEnd()()),2&c){const l=t.\u0275\u0275nextContext();t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(4,5,"Booking.DateTimeReservationNew")),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind2(10,7,l.eventEdit.dateTimeStartNew,"yyyy - MM - dd")),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",(null==l.formEvent.controls.timeStart?null:l.formEvent.controls.timeStart.invalid)&&(null==l.formEvent.controls.timeStart?null:l.formEvent.controls.timeStart.touched)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",(null==l.formEvent.controls.timeEnd?null:l.formEvent.controls.timeEnd.invalid)&&(null==l.formEvent.controls.timeEnd?null:l.formEvent.controls.timeEnd.touched)),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",null==l.formEvent.errors?null:l.formEvent.errors.invalidTimeOrder)}}function W(c,P){1&c&&(t.\u0275\u0275elementStart(0,"small"),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&c&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function U(c,P){if(1&c&&(t.\u0275\u0275elementStart(0,"div",37),t.\u0275\u0275template(1,W,3,3,"small",38),t.\u0275\u0275elementEnd()),2&c){const l=t.\u0275\u0275nextContext();t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",null==l.formEvent.controls.customer||null==l.formEvent.controls.customer.errors?null:l.formEvent.controls.customer.errors.required)}}function e(c,P){1&c&&(t.\u0275\u0275elementStart(0,"div",11)(1,"label",39),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"select",40,0)(6,"option",41),t.\u0275\u0275text(7),t.\u0275\u0275pipe(8,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"option",42),t.\u0275\u0275text(10),t.\u0275\u0275pipe(11,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(12,"option",43),t.\u0275\u0275text(13),t.\u0275\u0275pipe(14,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(15,"option",44),t.\u0275\u0275text(16),t.\u0275\u0275pipe(17,"translate"),t.\u0275\u0275elementEnd()()()),2&c&&(t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,5,"Booking.PaymentType")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(8,7,"Select.SelectOption")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(11,9,"Booking.Cash")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(14,11,"Booking.TDebit")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(17,13,"Booking.TCredit")))}let K=(()=>{class c{constructor(l,M,_){this.formBuilder=l,this.bookingService=M,this.commonsLibService=_,this.subscription=new y.Subscription,this.formEvent=new d.FormGroup({}),this.msgSave="",this.eventEdit=new I.k,this.actionState=g.ActionEnum.None,this.onAddCustomer=new t.EventEmitter,this.browserId=g.BrowserIdEnum.BrowserCustomer,this.selectId=g.SelectIdEnum.ListCourt}ngOnInit(){this.formEvent=this.formBuilder.group({dateTimeStart:[""],dateTimeEnd:[""],dateTimeStartNew:[""],dateTimeEndNew:[""],timeStart:["",[d.Validators.required]],timeEnd:["",[d.Validators.required]],customer:["",[d.Validators.required]],court:[],isRecurrent:[!1],observation:[""],paymentType:["0"],valueCourt:["0"],totalValue:["0"]})}formatTime(l){return`${l.getHours().toString().padStart(2,"0")}:${l.getMinutes().toString().padStart(2,"0")}`}ngOnChanges(l){l.actionState&&this.handleActionStateChange(l.actionState.currentValue)}handleActionStateChange(l){this.formEvent.enable(),this.actionState==g.ActionEnum.Edit&&(this.formEvent.disable(),this.formEvent.controls.observation.enable(),this.formEvent.controls.timeStart.enable(),this.formEvent.controls.timeEnd.enable())}get autocompleteCustomer(){return this.formEvent.get("customer")}get selectCourt(){return this.formEvent.get("court")}getEvent(){if(this.formEvent.markAllAsTouched(),this.formEvent.valid){let l=this.formEvent.getRawValue();return l.idBooking=this.eventEdit.idBooking,l.paymentType=Number(l.paymentType),this.actionState==g.ActionEnum.Edit&&(l.dateTimeStart=this.commonsLibService.getFormatIsoDate(l.dateTimeStartNew,l.timeStart),l.dateTimeEnd=this.commonsLibService.getFormatIsoDate(l.dateTimeEndNew,l.timeEnd)),l}return null}loadEvent(l){this.eventEdit=l,this.getPrice(),this.formEvent.patchValue(l);const M=this.formatTime(new Date(this.eventEdit.dateTimeStartNew)),_=this.formatTime(new Date(this.eventEdit.dateTimeEndNew));this.formEvent.get("timeStart")?.setValue(M),this.formEvent.get("timeEnd")?.setValue(_)}getPrice(){const l=this.commonsLibService.getTime(this.eventEdit.dateTimeStart),M=this.commonsLibService.getTime(this.eventEdit.dateTimeEnd);this.subscription.add(this.bookingService.getCourtValue(this.eventEdit.day,l,M,this.eventEdit.court.id).subscribe({next:_=>{this.eventEdit.valueCourt=_.value,this.eventEdit.totalValue=_.totalValue,this.eventEdit.totalHours=_.totalHours,this.eventEdit.hours=_.hours,this.formEvent.controls.valueCourt.setValue(_.value),this.formEvent.controls.totalValue.setValue(_.totalValue)},error:_=>{console.error(_)}}))}clicItemSelected(l){this.onAddCustomer.emit(!0)}setCustomer(l){this.formEvent.controls.customer.setValue({id:l.idCustomer,text:l.name,args:l})}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(M){return new(M||c)(t.\u0275\u0275directiveInject(d.FormBuilder),t.\u0275\u0275directiveInject(h.L),t.\u0275\u0275directiveInject(g.CommonsLibService))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:c,selectors:[["app-event"]],inputs:{actionState:"actionState"},outputs:{onAddCustomer:"onAddCustomer"},standalone:!0,features:[t.\u0275\u0275NgOnChangesFeature,t.\u0275\u0275StandaloneFeature],decls:66,vars:47,consts:[["paymentType",""],[3,"formGroup"],[1,"row"],[1,"col-6"],[1,"mb-4"],[1,"form-label"],[1,"nav","nav-pills","nav-primary"],[1,"nav-item"],["href","#",1,"nav-link","disabled"],["class","col-6",4,"ngIf"],[1,"col-7"],[1,"mb-3"],["for","CustomerBooking",1,"form-label"],["formControlName","customer",3,"onItemSelected","browserId","addItem"],["class","text-danger",4,"ngIf"],[1,"mb-2"],["for","observation"],["formControlName","observation","id","observation","rows","4",1,"form-control"],[1,"form-check","form-switch",3,"title"],["formControlName","isRecurrent","type","checkbox","role","switch","id","flexSwitchCheckDefault","aria-checked","false",1,"form-check-input"],["for","flexSwitchCheckDefault",1,"form-check-label"],[1,"col-5"],[1,"card","card-stats","card-info","card-round"],[1,"card-body"],[1,"icon-big","text-center"],[1,"fa-solid","fa-hand-holding-dollar","icon-large"],[1,"col-7","col-stats"],[1,"numbers"],[1,"card-category"],[1,"card-footer"],["class","mb-3",4,"ngIf"],[1,"container"],[1,"row","align-items-center"],[1,"col-12","col-md-4"],[1,"col-12","col-md-4","p-0"],["type","time","formControlName","timeStart","id","timeStart",1,"form-control","w-100"],["type","time","formControlName","timeEnd","id","timeEnd",1,"form-control","w-100"],[1,"text-danger"],[4,"ngIf"],["for","paymentType",1,"form-label"],["id","paymentType","formControlName","paymentType",1,"form-select"],["value","0"],["value","1"],["value","2"],["value","3"]],template:function(M,_){1&M&&(t.\u0275\u0275elementStart(0,"form",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"label",5),t.\u0275\u0275text(5),t.\u0275\u0275pipe(6,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div")(8,"ul",6)(9,"li",7)(10,"a",8),t.\u0275\u0275text(11),t.\u0275\u0275pipe(12,"date"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(13,"li",7)(14,"a",8),t.\u0275\u0275text(15),t.\u0275\u0275pipe(16,"date"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(17,"li",7)(18,"a",8),t.\u0275\u0275text(19),t.\u0275\u0275pipe(20,"date"),t.\u0275\u0275elementEnd()()()()()(),t.\u0275\u0275template(21,R,18,10,"div",9),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(22,"div",2)(23,"div",10)(24,"div",11)(25,"label",12),t.\u0275\u0275text(26),t.\u0275\u0275pipe(27,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(28,"lib-browser",13),t.\u0275\u0275listener("onItemSelected",function(N){return _.clicItemSelected(N)}),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(29,U,2,1,"div",14),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(30,"div",15)(31,"label",16),t.\u0275\u0275text(32),t.\u0275\u0275pipe(33,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(34,"textarea",17),t.\u0275\u0275text(35," "),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(36,"div")(37,"div",18),t.\u0275\u0275pipe(38,"translate"),t.\u0275\u0275element(39,"input",19),t.\u0275\u0275elementStart(40,"label",20),t.\u0275\u0275text(41),t.\u0275\u0275pipe(42,"translate"),t.\u0275\u0275elementEnd()()()(),t.\u0275\u0275elementStart(43,"div",21)(44,"div",22)(45,"div",23)(46,"div",2)(47,"div",21)(48,"div",24),t.\u0275\u0275element(49,"i",25),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(50,"div",26)(51,"div",27)(52,"p",28),t.\u0275\u0275text(53),t.\u0275\u0275pipe(54,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(55,"h1"),t.\u0275\u0275text(56),t.\u0275\u0275pipe(57,"number"),t.\u0275\u0275elementEnd()()()()(),t.\u0275\u0275elementStart(58,"div",29)(59,"div"),t.\u0275\u0275text(60),t.\u0275\u0275pipe(61,"translate"),t.\u0275\u0275elementStart(62,"strong"),t.\u0275\u0275text(63),t.\u0275\u0275pipe(64,"number"),t.\u0275\u0275elementEnd()()()()()(),t.\u0275\u0275template(65,e,18,15,"div",30),t.\u0275\u0275elementEnd()),2&M&&(t.\u0275\u0275property("formGroup",_.formEvent),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(6,18,"Booking.DateTimeReservation")),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind2(12,20,_.eventEdit.dateTimeStart,"yyyy - MM - dd")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind2(16,23,_.eventEdit.dateTimeStart,"h : mm a")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind2(20,26,_.eventEdit.dateTimeEnd,"h : mm a")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",2==_.actionState),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(27,29,"Booking.CustomerBooking")),t.\u0275\u0275advance(2),t.\u0275\u0275property("browserId",_.browserId)("addItem",!0),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",(null==_.formEvent.controls.customer?null:_.formEvent.controls.customer.invalid)&&(null==_.formEvent.controls.customer?null:_.formEvent.controls.customer.touched)),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(33,31,"Booking.Comment")),t.\u0275\u0275advance(5),t.\u0275\u0275propertyInterpolate("title",t.\u0275\u0275pipeBind1(38,33,"Tooltip.RecurringBooking")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(42,35,"Booking.IsRecurringBooking")),t.\u0275\u0275advance(12),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(54,37,"Booking.TotalValue")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("$ ",t.\u0275\u0275pipeBind2(57,39,_.eventEdit.totalValue,"1.0-0"),""),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(61,42,"Booking.HourValue"),": "),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("$ ",t.\u0275\u0275pipeBind2(64,44,_.eventEdit.valueCourt,"1.0-0"),""),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",3==_.actionState))},dependencies:[s.CommonModule,s.NgIf,s.DecimalPipe,s.DatePipe,a.TranslateModule,a.TranslatePipe,d.ReactiveFormsModule,d.\u0275NgNoValidate,d.NgSelectOption,d.\u0275NgSelectMultipleOption,d.DefaultValueAccessor,d.CheckboxControlValueAccessor,d.SelectControlValueAccessor,d.NgControlStatus,d.NgControlStatusGroup,d.FormGroupDirective,d.FormControlName,g.BrowserComponent],styles:[".ui-datepicker[_ngcontent-%COMP%]{z-index:1051!important}.icon-large[_ngcontent-%COMP%]{font-size:55px}"]})}}return c})()},7810:(T,E,n)=>{n.d(E,{k:()=>x});var s=n(8648),t=n(6762),d=n(1522),a=n(3274);function g(h,A){1&h&&(a.\u0275\u0275elementStart(0,"small"),a.\u0275\u0275text(1),a.\u0275\u0275pipe(2,"translate"),a.\u0275\u0275elementEnd()),2&h&&(a.\u0275\u0275advance(),a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function u(h,A){if(1&h&&(a.\u0275\u0275elementStart(0,"div",8),a.\u0275\u0275template(1,g,3,3,"small",9),a.\u0275\u0275elementEnd()),2&h){const m=a.\u0275\u0275nextContext();a.\u0275\u0275advance(),a.\u0275\u0275property("ngIf",null==m.formCustomer.controls.name||null==m.formCustomer.controls.name.errors?null:m.formCustomer.controls.name.errors.required)}}function I(h,A){1&h&&(a.\u0275\u0275elementStart(0,"small"),a.\u0275\u0275text(1),a.\u0275\u0275pipe(2,"translate"),a.\u0275\u0275elementEnd()),2&h&&(a.\u0275\u0275advance(),a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind1(2,1,"Validations.FieldRequired")))}function y(h,A){if(1&h&&(a.\u0275\u0275elementStart(0,"div",8),a.\u0275\u0275template(1,I,3,3,"small",9),a.\u0275\u0275elementEnd()),2&h){const m=a.\u0275\u0275nextContext();a.\u0275\u0275advance(),a.\u0275\u0275property("ngIf",null==m.formCustomer.controls.phone||null==m.formCustomer.controls.phone.errors?null:m.formCustomer.controls.phone.errors.required)}}let x=(()=>{class h{constructor(m,b){this.translate=m,this.formBuilder=b,this.formCustomer=new t.FormGroup({})}ngOnInit(){this.formCustomer=this.formBuilder.group({name:["",[t.Validators.required]],phone:["",[t.Validators.required]]})}getCustomer(){return this.formCustomer.markAllAsTouched(),this.formCustomer.valid?this.formCustomer.getRawValue():null}static{this.\u0275fac=function(b){return new(b||h)(a.\u0275\u0275directiveInject(d.TranslateService),a.\u0275\u0275directiveInject(t.FormBuilder))}}static{this.\u0275cmp=a.\u0275\u0275defineComponent({type:h,selectors:[["app-new-customer"]],standalone:!0,features:[a.\u0275\u0275StandaloneFeature],decls:15,vars:9,consts:[[3,"formGroup"],[1,"row"],[1,"col"],["for","name",1,"form-label"],["type","text","formControlName","name","id","name",1,"form-control"],["class","text-danger",4,"ngIf"],["for","phone",1,"form-label"],["type","text","formControlName","phone","id","phone",1,"form-control"],[1,"text-danger"],[4,"ngIf"]],template:function(b,S){1&b&&(a.\u0275\u0275elementStart(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),a.\u0275\u0275text(4),a.\u0275\u0275pipe(5,"translate"),a.\u0275\u0275elementEnd(),a.\u0275\u0275element(6,"input",4),a.\u0275\u0275template(7,u,2,1,"div",5),a.\u0275\u0275elementEnd()(),a.\u0275\u0275elementStart(8,"div",1)(9,"div",2)(10,"label",6),a.\u0275\u0275text(11),a.\u0275\u0275pipe(12,"translate"),a.\u0275\u0275elementEnd(),a.\u0275\u0275element(13,"input",7),a.\u0275\u0275template(14,y,2,1,"div",5),a.\u0275\u0275elementEnd()()()),2&b&&(a.\u0275\u0275property("formGroup",S.formCustomer),a.\u0275\u0275advance(4),a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind1(5,5,"Booking.NameCustomer")),a.\u0275\u0275advance(3),a.\u0275\u0275property("ngIf",(null==S.formCustomer.controls.name?null:S.formCustomer.controls.name.invalid)&&(null==S.formCustomer.controls.name?null:S.formCustomer.controls.name.touched)),a.\u0275\u0275advance(4),a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind1(12,7,"Booking.PhoneCustomer")),a.\u0275\u0275advance(3),a.\u0275\u0275property("ngIf",(null==S.formCustomer.controls.phone?null:S.formCustomer.controls.phone.invalid)&&(null==S.formCustomer.controls.phone?null:S.formCustomer.controls.phone.touched)))},dependencies:[s.CommonModule,s.NgIf,d.TranslateModule,d.TranslatePipe,t.ReactiveFormsModule,t.\u0275NgNoValidate,t.DefaultValueAccessor,t.NgControlStatus,t.NgControlStatusGroup,t.FormGroupDirective,t.FormControlName]})}}return h})()},5326:(T,E,n)=>{n.d(E,{H:()=>t});var s=n(8883);class t{constructor(){this.dateTimeStart=new Date,this.dateTimeEnd=new Date,this.idCourt=-1,this.paymentStatus=s.PaymentStatusEnum.Pending,this.paymentType=s.PaymentTypeEnum.None,this.isRecurrent=!1,this.observation="",this.dateCreated=(new Date).toISOString(),this.dateUpdated=(new Date).toISOString(),this.valueCourt=0,this.totalValue=0}}},9686:(T,E,n)=>{n.d(E,{f:()=>f});var s=n(1377);class f extends s.I{}},2419:(T,E,n)=>{n.d(E,{m:()=>f});var s=n(1377);class f extends s.I{}},2977:(T,E,n)=>{n.d(E,{k:()=>C});var s=n(8883),t=n(9686);class C{constructor(){this.idBooking=-1,this.dateTimeStart=new Date,this.dateTimeEnd=new Date,this.dateTimeStartNew=new Date,this.dateTimeEndNew=new Date,this.court=new t.f,this.observation="",this.isRecurrent=!1,this.paymentType=s.PaymentTypeEnum.None,this.paymentStatus=s.PaymentStatusEnum.Pending,this.timeStart="",this.timeEnd="",this.day=0,this.valueCourt=0,this.totalValue=0,this.totalHours=0,this.hours=0}}},1377:(T,E,n)=>{n.d(E,{I:()=>s});class s{constructor(){this.text="",this.args=""}}},122:(T,E,n)=>{n.d(E,{W:()=>C});var s=n(9784),f=n(3274);let C=(()=>{class d{static{this.\u0275fac=function(p){return new(p||d)}}static{this.\u0275cmp=f.\u0275\u0275defineComponent({type:d,selectors:[["app-booking"]],standalone:!0,features:[f.\u0275\u0275StandaloneFeature],decls:1,vars:0,template:function(p,g){1&p&&f.\u0275\u0275element(0,"app-calendar")},dependencies:[s.S]})}}return d})()},8970:(T,E,n)=>{n.d(E,{L:()=>a});var s=n(8883),t=n(3274),d=n(6306);let a=(()=>{class p{constructor(u){this.http=u,this.apiUrl=s.ApiEnum.Booking,this.apiUrlCustomer=s.ApiEnum.Customer}create(u){return this.http.post(`${this.apiUrl}Create`,u)}createCustomer(u){return this.http.post(`${this.apiUrlCustomer}QuickCreate`,u)}getEvents(u){return this.http.get(`${this.apiUrl}GetEvents/${u}`)}update(u){return this.http.put(`${this.apiUrl}Update`,u)}delete(u){return this.http.delete(`${this.apiUrl}Delete/${u}`)}updatePay(u){return this.http.put(`${this.apiUrl}UpdatePay`,u)}getCourtValue(u,I,y,x){return this.http.get(`${this.apiUrl}GetCourtValue/${u}/${I}/${y}/${x}`)}static{this.\u0275fac=function(I){return new(I||p)(t.\u0275\u0275inject(d.HttpClient))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:p,factory:p.\u0275fac,providedIn:"root"})}}return p})()},2857:(T,E,n)=>{n.d(E,{Q:()=>a});var s=n(8883),t=n(3274),d=n(6306);let a=(()=>{class p{constructor(u){this.http=u,this.apiUrl=s.ApiEnum.HoliDay}getHoliDays(u){return this.http.get(`${this.apiUrl}GetHoliDayByYear/${u}`)}static{this.\u0275fac=function(I){return new(I||p)(t.\u0275\u0275inject(d.HttpClient))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:p,factory:p.\u0275fac,providedIn:"root"})}}return p})()}}]);